![acm-Page-2](https://github.com/harlowk/gr-auth/assets/26778165/95091b18-2669-4de5-bbda-ebb750831394)
## Design Document
# Platform Access Control Model (ACM)

started: 2022-OCTOBER-21

Harlow, K

This RFC blueprints a Platform Access Control Model (ACM).

## Summary

Goal: 

- Centralized and Standardized Access Control Model
- Authentication and Authorization At Central Gateway
- Consolidated Approach to Access Assignment / Fully Embrace Policy-Based Model

Method: 

- (I)   Having a service→resource attribute map used to describe and evaluate access.
- (II)  Consolidating how access is assigned to a single strategy: *by policy.*
- (III) Enforcing authentication and authorizations at a centralized gateway


# Summary Architecture

 

The proposed access control model (ACM) is framed by the principles: (a) access is **described via resource;** and (b) access is **granted via policy**. 

That is, (I) we **(*service owners*) **describe a universe of resources made available by our public APIs; (II) consumers (*************resource owners*************) define policies ****************for *who* *can access what* within the bounds of that universe; and (III) those policies *prevent*, *determine*, *audit*, and *grant* access in the Platform. The ACM infrastructure models three (decoupled) parts: 

(I) Resource Attribution And Discoverability Model **(RAD\M)**

RAD\M infrastructure centralizes the collection of resources exposed in our platform (called the ******************resource universe******************); and a mapping of service endpoints that act on those resources (called **********************service statements**********************).

- The resource universe is a publicly discoverable list of resources; a *********resource********* is an attribute-like name representing a service data type, or collection of types, referenced in authorization policies **(PBA) to assign access to APIs which have that resource attributed.
- The service statements **are an internal mapping of service endpoints→resource; a *service statement* attributes a resource to a particular service path (or wildcard) endpoint. The central enforcement point (CEP) evaluates policy access to a requested resource by comparing what the policy allows vs. what is required by the best matched service statement.

The RAD **model **relies on ingestion of a configuration file at the individual service-level of public APIs. These service-level files are compiled to form both the *resource universe* and *service statements*, then made discoverable via a centralized broker-like agent. The primary utility of RAD is to provide necessary context for (a) authorization to be centrally enforced; (b) access assignments to be determinable and auditable; (c) to have a determinable rule set for evaluating access; (d) anti-corruption layer.

- (I.1) *Resource Attributions* (*s* manipulates *r*) **are explicitly defined for every service’s public API.
- (I.2) *Resource Attributions* (*s* manipulates *r*) **are decoupled from any authorization-related designations.
- (I.3) *Resource Attributions* (*s* manipulates *r*) **are decoupled from service functional code.
- (I.4) *Resource Attributions* (*s* manipulates *r*) **are defined within a specification language format.
- (I.5) *Resource Attributions* (*s* manipulates *r*) **are validated pre-service deployment.
- (I.6) *Resource Attributions* (*s* manipulates *r*) **are discoverable from a centralized broker.
- (I.7) *Resource Attributions* (*s* manipulates *r*) **are auditable.

![acm-Page-1](https://github.com/harlowk/gr-auth/assets/26778165/58e96cae-e7f5-4078-9de9-58bbcaa2e166)<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="683px" height="313px" viewBox="-0.5 -0.5 683 313" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 54.76 79.3 L 20 79.3 L 20 182 L 43.63 182" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 48.88 182 L 41.88 185.5 L 43.63 182 L 41.88 178.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 86.76 40.04 C 86.18 40.07 85.59 40.22 85.08 40.48 L 62.16 51.4 C 60.96 51.99 60.08 53.09 59.79 54.36 L 54.12 78.96 C 53.87 80.1 54.09 81.3 54.71 82.29 C 54.82 82.4 54.89 82.51 54.96 82.65 L 70.83 102.36 C 71.67 103.38 72.95 104 74.26 104 L 99.7 104 C 101.02 104 102.3 103.38 103.14 102.36 L 119 82.62 C 119.8 81.59 120.13 80.24 119.84 78.96 L 114.18 54.36 C 113.88 53.09 113.01 51.99 111.8 51.4 L 88.88 40.48 C 88.22 40.15 87.49 40 86.76 40.04 Z" fill="#ffffff" stroke="none" pointer-events="all"/><path d="M 86.78 41.95 C 86.23 41.99 85.68 42.13 85.2 42.37 L 63.65 52.64 C 62.52 53.19 61.7 54.22 61.42 55.42 L 56.1 78.55 C 55.85 79.61 56.06 80.74 56.65 81.67 C 56.75 81.77 56.82 81.88 56.89 82.02 L 71.8 100.53 C 72.59 101.5 73.79 102.08 75.03 102.08 L 98.94 102.08 C 100.18 102.08 101.38 101.5 102.17 100.53 L 117.08 81.98 C 117.84 81.02 118.15 79.75 117.87 78.55 L 112.54 55.42 C 112.27 54.22 111.45 53.19 110.31 52.64 L 88.77 42.37 C 88.15 42.06 87.46 41.92 86.78 41.95 Z" fill="#002266" stroke="none" pointer-events="all"/><path d="M 87 52.8 C 86.61 52.8 75.15 58.44 75 58.71 C 74.65 59.42 72.03 71.42 72.18 71.69 C 72.27 71.84 74.14 74.21 76.37 76.97 L 80.38 81.99 L 86.97 81.99 L 93.56 81.99 L 97.75 76.77 L 101.97 71.51 L 100.48 65.07 C 99.68 61.53 98.97 58.56 98.88 58.5 C 98.67 58.29 87.24 52.83 87 52.8 Z M 87.71 58.71 C 88.28 58.74 88.34 59.57 89.52 59.66 C 91.07 59.78 90.89 58.32 92.08 59.33 C 93.27 60.34 91.81 60.4 92.2 61.92 C 92.55 63.43 93.86 62.84 93.3 64.26 C 92.7 65.69 92.17 64.35 90.86 65.15 C 89.52 65.99 90.5 67.06 88.96 66.94 C 87.42 66.82 88.54 65.9 87.36 64.89 C 86.17 63.91 85.46 65.15 85.1 63.64 C 84.71 62.15 85.93 62.93 86.52 61.5 C 87.12 60.05 85.69 59.78 87.03 58.95 C 87.18 58.86 87.33 58.8 87.45 58.74 C 87.53 58.71 87.62 58.71 87.71 58.71 Z M 89.26 60.4 C 89.05 60.4 88.81 60.43 88.6 60.49 C 87.42 60.85 86.73 62.1 87.09 63.28 C 87.45 64.47 88.72 65.15 89.91 64.8 C 91.1 64.44 91.75 63.19 91.4 62.01 C 91.13 61.06 90.24 60.4 89.26 60.4 Z M 80.38 64.26 C 80.5 64.26 80.64 64.29 80.82 64.35 C 82.25 64.8 80.79 65.54 81.8 66.64 C 82.81 67.71 83.67 66.31 84 67.77 C 84.36 69.22 82.96 68.36 82.55 69.79 C 82.1 71.21 83.73 71.24 82.63 72.25 C 81.54 73.26 81.62 71.66 80.17 71.99 C 78.71 72.31 79.49 73.74 78.06 73.32 C 76.64 72.88 78.09 72.13 77.08 71.03 C 76.07 69.94 75.21 71.33 74.88 69.88 C 74.53 68.42 75.92 69.31 76.34 67.89 C 76.78 66.46 75.15 66.4 76.25 65.39 C 77.35 64.38 77.26 66.02 78.71 65.69 C 79.99 65.39 79.55 64.26 80.38 64.26 Z M 90.98 65.84 C 91.1 65.84 91.28 65.87 91.48 65.93 C 93.12 66.58 90.95 67.56 92.23 68.78 C 93.5 70 94.39 67.8 95.11 69.4 C 95.82 71.01 93.59 70.17 93.62 71.96 C 93.65 73.71 95.85 72.79 95.23 74.42 C 94.57 76.05 93.59 73.89 92.38 75.16 C 91.16 76.44 93.36 77.33 91.75 78.04 C 90.15 78.76 90.98 76.53 89.2 76.56 C 87.45 76.62 88.37 78.79 86.73 78.16 C 85.1 77.51 87.27 76.53 85.99 75.31 C 84.71 74.09 83.82 76.29 83.11 74.69 C 82.4 73.08 84.62 73.92 84.59 72.16 C 84.54 70.38 82.37 71.33 82.99 69.67 C 83.64 68.04 84.62 70.2 85.84 68.93 C 87.06 67.65 84.86 66.76 86.47 66.05 C 88.07 65.33 87.24 67.56 88.99 67.53 C 90.53 67.5 90.03 65.81 90.98 65.84 Z M 79.46 66.58 C 78.21 66.58 77.2 67.59 77.2 68.84 C 77.2 70.08 78.21 71.06 79.46 71.06 C 80.67 71.06 81.68 70.08 81.68 68.84 C 81.68 67.59 80.67 66.58 79.46 66.58 Z M 89.11 68.75 C 87.27 68.75 85.78 70.2 85.78 72.04 C 85.78 73.89 87.27 75.37 89.11 75.37 C 90.95 75.37 92.41 73.89 92.41 72.04 C 92.41 70.2 90.92 68.75 89.11 68.75 Z M 91.48 84.37 L 91.48 83.54 L 92.23 83.54 L 92.23 84.37 Z M 91.48 89.54 L 91.48 85.2 L 92.23 85.2 L 92.23 89.54 Z M 86.82 91.2 L 86.82 85.2 L 87.5 85.2 L 87.5 85.77 Q 87.74 85.41 88.04 85.26 Q 88.34 85.08 88.75 85.08 Q 89.32 85.08 89.73 85.38 Q 90.15 85.68 90.39 86.18 Q 90.59 86.72 90.59 87.34 Q 90.59 87.99 90.36 88.53 Q 90.12 89.06 89.64 89.36 Q 89.2 89.63 88.69 89.63 Q 88.34 89.63 88.04 89.48 Q 87.74 89.33 87.56 89.09 L 87.56 91.2 Z M 87.48 87.4 Q 87.48 88.23 87.83 88.62 Q 88.16 89.03 88.66 89.03 Q 89.14 89.03 89.49 88.62 Q 89.85 88.2 89.85 87.34 Q 89.85 86.51 89.49 86.09 Q 89.17 85.68 88.69 85.68 Q 88.22 85.68 87.86 86.12 Q 87.48 86.54 87.48 87.4 Z M 84.98 89 Q 84.59 89.36 84.21 89.48 Q 83.82 89.63 83.41 89.63 Q 82.66 89.63 82.28 89.3 Q 81.89 88.94 81.89 88.38 Q 81.89 88.08 82.04 87.81 Q 82.19 87.55 82.43 87.37 Q 82.66 87.22 82.96 87.13 Q 83.17 87.07 83.61 87.04 Q 84.51 86.92 84.92 86.77 Q 84.92 86.63 84.92 86.6 Q 84.92 86.12 84.71 85.94 Q 84.45 85.71 83.88 85.71 Q 83.38 85.71 83.11 85.88 Q 82.87 86.06 82.75 86.54 L 82.04 86.42 Q 82.13 85.97 82.37 85.68 Q 82.57 85.41 83.02 85.23 Q 83.44 85.08 84 85.08 Q 84.56 85.08 84.89 85.23 Q 85.25 85.35 85.4 85.56 Q 85.57 85.74 85.63 86.06 Q 85.66 86.24 85.66 86.75 L 85.66 87.73 Q 85.66 88.74 85.72 89 Q 85.78 89.3 85.9 89.54 L 85.13 89.54 Q 85.01 89.3 84.98 89 Z M 84.92 87.34 Q 84.54 87.52 83.73 87.64 Q 83.29 87.7 83.08 87.78 Q 82.9 87.87 82.78 88.02 Q 82.69 88.17 82.69 88.38 Q 82.69 88.68 82.9 88.85 Q 83.14 89.06 83.55 89.06 Q 84 89.06 84.33 88.88 Q 84.65 88.68 84.8 88.35 Q 84.92 88.11 84.92 87.64 Z" fill="#ffffff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 111px; margin-left: 87px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 22px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><p style="font-size: 12px;"><br /></p></div></div></div></foreignObject><text x="87" y="133" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="22px" text-anchor="middle"></text></switch></g><path d="M 103.49 152 L 103.49 212 L 54 212 L 54 142 L 96.42 142 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 96.42 142 C 97 144.34 96.05 146.75 93.9 148.43 L 104 152.5 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 107.49 158 L 107.49 218 L 58 218 L 58 148 L 100.42 148 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 100.42 148 C 101 150.34 100.05 152.75 97.9 154.43 L 108 158.5 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 111.49 164 L 111.49 224 L 62 224 L 62 154 L 104.42 154 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 104.42 154 C 105 156.34 104.05 158.75 101.9 160.43 L 112 164.5 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 82.76 40.04 C 82.18 40.07 81.59 40.22 81.08 40.48 L 58.16 51.4 C 56.96 51.99 56.08 53.09 55.79 54.36 L 50.12 78.96 C 49.87 80.1 50.09 81.3 50.71 82.29 C 50.82 82.4 50.89 82.51 50.96 82.65 L 66.83 102.36 C 67.67 103.38 68.95 104 70.26 104 L 95.7 104 C 97.02 104 98.3 103.38 99.14 102.36 L 115 82.62 C 115.8 81.59 116.13 80.24 115.84 78.96 L 110.18 54.36 C 109.88 53.09 109.01 51.99 107.8 51.4 L 84.88 40.48 C 84.22 40.15 83.49 40 82.76 40.04 Z" fill="#ffffff" stroke="none" pointer-events="all"/><path d="M 82.78 41.95 C 82.23 41.99 81.68 42.13 81.2 42.37 L 59.65 52.64 C 58.52 53.19 57.7 54.22 57.42 55.42 L 52.1 78.55 C 51.85 79.61 52.06 80.74 52.65 81.67 C 52.75 81.77 52.82 81.88 52.89 82.02 L 67.8 100.53 C 68.59 101.5 69.79 102.08 71.03 102.08 L 94.94 102.08 C 96.18 102.08 97.38 101.5 98.17 100.53 L 113.08 81.98 C 113.84 81.02 114.15 79.75 113.87 78.55 L 108.54 55.42 C 108.27 54.22 107.45 53.19 106.31 52.64 L 84.77 42.37 C 84.15 42.06 83.46 41.92 82.78 41.95 Z" fill="#0050ef" stroke="none" pointer-events="all"/><path d="M 83 52.8 C 82.61 52.8 71.15 58.44 71 58.71 C 70.65 59.42 68.03 71.42 68.18 71.69 C 68.27 71.84 70.14 74.21 72.37 76.97 L 76.38 81.99 L 82.97 81.99 L 89.56 81.99 L 93.75 76.77 L 97.97 71.51 L 96.48 65.07 C 95.68 61.53 94.97 58.56 94.88 58.5 C 94.67 58.29 83.24 52.83 83 52.8 Z M 83.71 58.71 C 84.28 58.74 84.34 59.57 85.52 59.66 C 87.07 59.78 86.89 58.32 88.08 59.33 C 89.27 60.34 87.81 60.4 88.2 61.92 C 88.55 63.43 89.86 62.84 89.3 64.26 C 88.7 65.69 88.17 64.35 86.86 65.15 C 85.52 65.99 86.5 67.06 84.96 66.94 C 83.42 66.82 84.54 65.9 83.36 64.89 C 82.17 63.91 81.46 65.15 81.1 63.64 C 80.71 62.15 81.93 62.93 82.52 61.5 C 83.12 60.05 81.69 59.78 83.03 58.95 C 83.18 58.86 83.33 58.8 83.45 58.74 C 83.53 58.71 83.62 58.71 83.71 58.71 Z M 85.26 60.4 C 85.05 60.4 84.81 60.43 84.6 60.49 C 83.42 60.85 82.73 62.1 83.09 63.28 C 83.45 64.47 84.72 65.15 85.91 64.8 C 87.1 64.44 87.75 63.19 87.4 62.01 C 87.13 61.06 86.24 60.4 85.26 60.4 Z M 76.38 64.26 C 76.5 64.26 76.64 64.29 76.82 64.35 C 78.25 64.8 76.79 65.54 77.8 66.64 C 78.81 67.71 79.67 66.31 80 67.77 C 80.36 69.22 78.96 68.36 78.55 69.79 C 78.1 71.21 79.73 71.24 78.63 72.25 C 77.54 73.26 77.62 71.66 76.17 71.99 C 74.71 72.31 75.49 73.74 74.06 73.32 C 72.64 72.88 74.09 72.13 73.08 71.03 C 72.07 69.94 71.21 71.33 70.88 69.88 C 70.53 68.42 71.92 69.31 72.34 67.89 C 72.78 66.46 71.15 66.4 72.25 65.39 C 73.35 64.38 73.26 66.02 74.71 65.69 C 75.99 65.39 75.55 64.26 76.38 64.26 Z M 86.98 65.84 C 87.1 65.84 87.28 65.87 87.48 65.93 C 89.12 66.58 86.95 67.56 88.23 68.78 C 89.5 70 90.39 67.8 91.11 69.4 C 91.82 71.01 89.59 70.17 89.62 71.96 C 89.65 73.71 91.85 72.79 91.23 74.42 C 90.57 76.05 89.59 73.89 88.38 75.16 C 87.16 76.44 89.36 77.33 87.75 78.04 C 86.15 78.76 86.98 76.53 85.2 76.56 C 83.45 76.62 84.37 78.79 82.73 78.16 C 81.1 77.51 83.27 76.53 81.99 75.31 C 80.71 74.09 79.82 76.29 79.11 74.69 C 78.4 73.08 80.62 73.92 80.59 72.16 C 80.54 70.38 78.37 71.33 78.99 69.67 C 79.64 68.04 80.62 70.2 81.84 68.93 C 83.06 67.65 80.86 66.76 82.47 66.05 C 84.07 65.33 83.24 67.56 84.99 67.53 C 86.53 67.5 86.03 65.81 86.98 65.84 Z M 75.46 66.58 C 74.21 66.58 73.2 67.59 73.2 68.84 C 73.2 70.08 74.21 71.06 75.46 71.06 C 76.67 71.06 77.68 70.08 77.68 68.84 C 77.68 67.59 76.67 66.58 75.46 66.58 Z M 85.11 68.75 C 83.27 68.75 81.78 70.2 81.78 72.04 C 81.78 73.89 83.27 75.37 85.11 75.37 C 86.95 75.37 88.41 73.89 88.41 72.04 C 88.41 70.2 86.92 68.75 85.11 68.75 Z M 87.48 84.37 L 87.48 83.54 L 88.23 83.54 L 88.23 84.37 Z M 87.48 89.54 L 87.48 85.2 L 88.23 85.2 L 88.23 89.54 Z M 82.82 91.2 L 82.82 85.2 L 83.5 85.2 L 83.5 85.77 Q 83.74 85.41 84.04 85.26 Q 84.34 85.08 84.75 85.08 Q 85.32 85.08 85.73 85.38 Q 86.15 85.68 86.39 86.18 Q 86.59 86.72 86.59 87.34 Q 86.59 87.99 86.36 88.53 Q 86.12 89.06 85.64 89.36 Q 85.2 89.63 84.69 89.63 Q 84.34 89.63 84.04 89.48 Q 83.74 89.33 83.56 89.09 L 83.56 91.2 Z M 83.48 87.4 Q 83.48 88.23 83.83 88.62 Q 84.16 89.03 84.66 89.03 Q 85.14 89.03 85.49 88.62 Q 85.85 88.2 85.85 87.34 Q 85.85 86.51 85.49 86.09 Q 85.17 85.68 84.69 85.68 Q 84.22 85.68 83.86 86.12 Q 83.48 86.54 83.48 87.4 Z M 80.98 89 Q 80.59 89.36 80.21 89.48 Q 79.82 89.63 79.41 89.63 Q 78.66 89.63 78.28 89.3 Q 77.89 88.94 77.89 88.38 Q 77.89 88.08 78.04 87.81 Q 78.19 87.55 78.43 87.37 Q 78.66 87.22 78.96 87.13 Q 79.17 87.07 79.61 87.04 Q 80.51 86.92 80.92 86.77 Q 80.92 86.63 80.92 86.6 Q 80.92 86.12 80.71 85.94 Q 80.45 85.71 79.88 85.71 Q 79.38 85.71 79.11 85.88 Q 78.87 86.06 78.75 86.54 L 78.04 86.42 Q 78.13 85.97 78.37 85.68 Q 78.57 85.41 79.02 85.23 Q 79.44 85.08 80 85.08 Q 80.56 85.08 80.89 85.23 Q 81.25 85.35 81.4 85.56 Q 81.57 85.74 81.63 86.06 Q 81.66 86.24 81.66 86.75 L 81.66 87.73 Q 81.66 88.74 81.72 89 Q 81.78 89.3 81.9 89.54 L 81.13 89.54 Q 81.01 89.3 80.98 89 Z M 80.92 87.34 Q 80.54 87.52 79.73 87.64 Q 79.29 87.7 79.08 87.78 Q 78.9 87.87 78.78 88.02 Q 78.69 88.17 78.69 88.38 Q 78.69 88.68 78.9 88.85 Q 79.14 89.06 79.55 89.06 Q 80 89.06 80.33 88.88 Q 80.65 88.68 80.8 88.35 Q 80.92 88.11 80.92 87.64 Z" fill="#ffffff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 111px; margin-left: 83px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 22px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: nowrap;"><p style="font-size: 12px;"><br /></p></div></div></div></foreignObject><text x="83" y="133" fill="#ffffff" font-family="Helvetica" font-size="22px" text-anchor="middle"></text></switch></g><path d="M 39.4 80.32 L 19 80.3 L 19 169.5 L 47.63 169.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 52.88 169.5 L 45.88 173 L 47.63 169.5 L 45.88 166 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 39.4 80.32 L 19 80.3 L 19 189 L 55.63 189" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 60.88 189 L 53.88 192.5 L 55.63 189 L 53.88 185.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 78.76 40.04 C 78.18 40.07 77.59 40.22 77.08 40.48 L 54.16 51.4 C 52.96 51.99 52.08 53.09 51.79 54.36 L 46.12 78.96 C 45.87 80.1 46.09 81.3 46.71 82.29 C 46.82 82.4 46.89 82.51 46.96 82.65 L 62.83 102.36 C 63.67 103.38 64.95 104 66.26 104 L 91.7 104 C 93.02 104 94.3 103.38 95.14 102.36 L 111 82.62 C 111.8 81.59 112.13 80.24 111.84 78.96 L 106.18 54.36 C 105.88 53.09 105.01 51.99 103.8 51.4 L 80.88 40.48 C 80.22 40.15 79.49 40 78.76 40.04 Z" fill="#3333ff" stroke="none" pointer-events="all"/><path d="M 78.78 41.95 C 78.23 41.99 77.68 42.13 77.2 42.37 L 55.65 52.64 C 54.52 53.19 53.7 54.22 53.42 55.42 L 48.1 78.55 C 47.85 79.61 48.06 80.74 48.65 81.67 C 48.75 81.77 48.82 81.88 48.89 82.02 L 63.8 100.53 C 64.59 101.5 65.79 102.08 67.03 102.08 L 90.94 102.08 C 92.18 102.08 93.38 101.5 94.17 100.53 L 109.08 81.98 C 109.84 81.02 110.15 79.75 109.87 78.55 L 104.54 55.42 C 104.27 54.22 103.45 53.19 102.31 52.64 L 80.77 42.37 C 80.15 42.06 79.46 41.92 78.78 41.95 Z" fill="rgb(255, 255, 255)" stroke="none" pointer-events="all"/><path d="M 79 52.8 C 78.61 52.8 67.15 58.44 67 58.71 C 66.65 59.42 64.03 71.42 64.18 71.69 C 64.27 71.84 66.14 74.21 68.37 76.97 L 72.38 81.99 L 78.97 81.99 L 85.56 81.99 L 89.75 76.77 L 93.97 71.51 L 92.48 65.07 C 91.68 61.53 90.97 58.56 90.88 58.5 C 90.67 58.29 79.24 52.83 79 52.8 Z M 79.71 58.71 C 80.28 58.74 80.34 59.57 81.52 59.66 C 83.07 59.78 82.89 58.32 84.08 59.33 C 85.27 60.34 83.81 60.4 84.2 61.92 C 84.55 63.43 85.86 62.84 85.3 64.26 C 84.7 65.69 84.17 64.35 82.86 65.15 C 81.52 65.99 82.5 67.06 80.96 66.94 C 79.42 66.82 80.54 65.9 79.36 64.89 C 78.17 63.91 77.46 65.15 77.1 63.64 C 76.71 62.15 77.93 62.93 78.52 61.5 C 79.12 60.05 77.69 59.78 79.03 58.95 C 79.18 58.86 79.33 58.8 79.45 58.74 C 79.53 58.71 79.62 58.71 79.71 58.71 Z M 81.26 60.4 C 81.05 60.4 80.81 60.43 80.6 60.49 C 79.42 60.85 78.73 62.1 79.09 63.28 C 79.45 64.47 80.72 65.15 81.91 64.8 C 83.1 64.44 83.75 63.19 83.4 62.01 C 83.13 61.06 82.24 60.4 81.26 60.4 Z M 72.38 64.26 C 72.5 64.26 72.64 64.29 72.82 64.35 C 74.25 64.8 72.79 65.54 73.8 66.64 C 74.81 67.71 75.67 66.31 76 67.77 C 76.36 69.22 74.96 68.36 74.55 69.79 C 74.1 71.21 75.73 71.24 74.63 72.25 C 73.54 73.26 73.62 71.66 72.17 71.99 C 70.71 72.31 71.49 73.74 70.06 73.32 C 68.64 72.88 70.09 72.13 69.08 71.03 C 68.07 69.94 67.21 71.33 66.88 69.88 C 66.53 68.42 67.92 69.31 68.34 67.89 C 68.78 66.46 67.15 66.4 68.25 65.39 C 69.35 64.38 69.26 66.02 70.71 65.69 C 71.99 65.39 71.55 64.26 72.38 64.26 Z M 82.98 65.84 C 83.1 65.84 83.28 65.87 83.48 65.93 C 85.12 66.58 82.95 67.56 84.23 68.78 C 85.5 70 86.39 67.8 87.11 69.4 C 87.82 71.01 85.59 70.17 85.62 71.96 C 85.65 73.71 87.85 72.79 87.23 74.42 C 86.57 76.05 85.59 73.89 84.38 75.16 C 83.16 76.44 85.36 77.33 83.75 78.04 C 82.15 78.76 82.98 76.53 81.2 76.56 C 79.45 76.62 80.37 78.79 78.73 78.16 C 77.1 77.51 79.27 76.53 77.99 75.31 C 76.71 74.09 75.82 76.29 75.11 74.69 C 74.4 73.08 76.62 73.92 76.59 72.16 C 76.54 70.38 74.37 71.33 74.99 69.67 C 75.64 68.04 76.62 70.2 77.84 68.93 C 79.06 67.65 76.86 66.76 78.47 66.05 C 80.07 65.33 79.24 67.56 80.99 67.53 C 82.53 67.5 82.03 65.81 82.98 65.84 Z M 71.46 66.58 C 70.21 66.58 69.2 67.59 69.2 68.84 C 69.2 70.08 70.21 71.06 71.46 71.06 C 72.67 71.06 73.68 70.08 73.68 68.84 C 73.68 67.59 72.67 66.58 71.46 66.58 Z M 81.11 68.75 C 79.27 68.75 77.78 70.2 77.78 72.04 C 77.78 73.89 79.27 75.37 81.11 75.37 C 82.95 75.37 84.41 73.89 84.41 72.04 C 84.41 70.2 82.92 68.75 81.11 68.75 Z M 83.48 84.37 L 83.48 83.54 L 84.23 83.54 L 84.23 84.37 Z M 83.48 89.54 L 83.48 85.2 L 84.23 85.2 L 84.23 89.54 Z M 78.82 91.2 L 78.82 85.2 L 79.5 85.2 L 79.5 85.77 Q 79.74 85.41 80.04 85.26 Q 80.34 85.08 80.75 85.08 Q 81.32 85.08 81.73 85.38 Q 82.15 85.68 82.39 86.18 Q 82.59 86.72 82.59 87.34 Q 82.59 87.99 82.36 88.53 Q 82.12 89.06 81.64 89.36 Q 81.2 89.63 80.69 89.63 Q 80.34 89.63 80.04 89.48 Q 79.74 89.33 79.56 89.09 L 79.56 91.2 Z M 79.48 87.4 Q 79.48 88.23 79.83 88.62 Q 80.16 89.03 80.66 89.03 Q 81.14 89.03 81.49 88.62 Q 81.85 88.2 81.85 87.34 Q 81.85 86.51 81.49 86.09 Q 81.17 85.68 80.69 85.68 Q 80.22 85.68 79.86 86.12 Q 79.48 86.54 79.48 87.4 Z M 76.98 89 Q 76.59 89.36 76.21 89.48 Q 75.82 89.63 75.41 89.63 Q 74.66 89.63 74.28 89.3 Q 73.89 88.94 73.89 88.38 Q 73.89 88.08 74.04 87.81 Q 74.19 87.55 74.43 87.37 Q 74.66 87.22 74.96 87.13 Q 75.17 87.07 75.61 87.04 Q 76.51 86.92 76.92 86.77 Q 76.92 86.63 76.92 86.6 Q 76.92 86.12 76.71 85.94 Q 76.45 85.71 75.88 85.71 Q 75.38 85.71 75.11 85.88 Q 74.87 86.06 74.75 86.54 L 74.04 86.42 Q 74.13 85.97 74.37 85.68 Q 74.57 85.41 75.02 85.23 Q 75.44 85.08 76 85.08 Q 76.56 85.08 76.89 85.23 Q 77.25 85.35 77.4 85.56 Q 77.57 85.74 77.63 86.06 Q 77.66 86.24 77.66 86.75 L 77.66 87.73 Q 77.66 88.74 77.72 89 Q 77.78 89.3 77.9 89.54 L 77.13 89.54 Q 77.01 89.3 76.98 89 Z M 76.92 87.34 Q 76.54 87.52 75.73 87.64 Q 75.29 87.7 75.08 87.78 Q 74.9 87.87 74.78 88.02 Q 74.69 88.17 74.69 88.38 Q 74.69 88.68 74.9 88.85 Q 75.14 89.06 75.55 89.06 Q 76 89.06 76.33 88.88 Q 76.65 88.68 76.8 88.35 Q 76.92 88.11 76.92 87.64 Z" fill="#3333ff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 111px; margin-left: 79px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 22px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><p style="font-size: 12px;"><br /></p></div></div></div></foreignObject><text x="79" y="133" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="22px" text-anchor="middle"></text></switch></g><rect x="144" y="20" width="237" height="132" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 229px; height: 1px; padding-top: 10px; margin-left: 149px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 142px; overflow: hidden;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1><font color="#3333ff"><span style="background-color: initial;">RAD\M</span><br /></font></h1><div><font style="font-size: 11px;">(1) Each service with a public API has a single resource configuration file that defines (a) its resources (b) its statements. These files are pushed to central storage on pre-deploy.</font></div></div></div></div></foreignObject><text x="149" y="22" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">RAD\M...</text></switch></g><rect x="54" y="162" width="60" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 177px; margin-left: 55px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 8px;" color="#3333ff">resources</font></div></div></div></foreignObject><text x="84" y="181" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">resources</text></switch></g><rect x="57" y="177" width="60" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 192px; margin-left: 58px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 8px;" color="#3333ff">statements</font></div></div></div></foreignObject><text x="87" y="196" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">statements</text></switch></g><path d="M 144 223 L 342.63 223" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 347.88 223 L 340.88 226.5 L 342.63 223 L 340.88 219.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 190.5 233.38 L 198 233.38 L 198 212.38 L 177 212.38 L 177 233.38 L 184.5 233.38" fill="rgb(255, 255, 255)" stroke="#3333ff" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 181.5 225.88 L 187.5 219.88 L 193.5 225.88 M 187.5 237.88 L 187.5 219.88" fill="none" stroke="#3333ff" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="144" y="247" width="209" height="55" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 207px; height: 1px; padding-top: 275px; margin-left: 146px;"><div data-drawio-colors="color: #3333FF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 8px; font-family: Helvetica; color: rgb(51, 51, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 11px;"><font color="#000000">(2) The API config files are compiled into one at central storage: creating the </font><i style="color: rgb(0, 0, 0);">master</i><font color="#000000"> </font><b style="">resource universe </b><font color="#000000">and </font><b style="">service statements</b></font></div></div></div></foreignObject><text x="146" y="277" fill="#3333FF" font-family="Helvetica" font-size="8px">(2) The API config files are compiled into one at ce...</text></switch></g><rect x="364" y="212" width="86.25" height="86.25" fill="none" stroke="none" pointer-events="all"/><path d="M 443.12 251.81 C 442.71 250.12 434.19 246.29 421.67 246.29 C 409.16 246.29 400.64 250.12 400.23 251.81 L 400.25 251.92 C 400.92 253.61 409.33 256.6 421.67 256.6 C 433.9 256.6 442.25 253.67 443.07 251.97 L 443.08 251.87 L 443.11 251.88 Z M 442.38 257.11 C 436.75 259.71 427.34 260.52 421.67 260.52 C 416 260.52 406.57 259.71 400.94 257.1 L 402.96 272.07 C 404.47 272.62 405.88 273.52 407.13 274.75 C 407.84 275.46 408.47 276.27 409 277.17 C 410.2 276.64 411.56 276.53 412.86 276.92 C 415.02 277.56 416.54 279.34 417.08 281.81 C 417.96 282.1 418.83 282.5 419.6 282.99 C 422.28 284.69 423.63 286.91 423.63 289.59 C 423.63 291.4 423.22 292.95 422.44 294.26 C 426.05 294.21 429.61 293.83 432.55 293.15 C 433.75 292.87 434.82 292.56 435.71 292.2 C 437.09 291.65 437.67 291.17 437.82 290.98 C 437.82 290.94 437.83 290.9 437.83 290.86 L 439.93 275.3 C 434.25 273.5 427.07 270.25 423.2 268.43 C 422.77 268.68 422.28 268.83 421.75 268.83 C 420.13 268.83 418.81 267.51 418.81 265.89 C 418.81 264.27 420.13 262.96 421.75 262.96 C 422.93 262.96 423.95 263.66 424.41 264.68 C 427.49 266.13 434.75 269.46 440.46 271.35 Z M 419.72 289.59 C 419.72 288.66 419.45 287.54 417.5 286.3 C 416.74 285.82 415.79 285.44 414.98 285.31 C 413.99 285.14 413.3 284.25 413.35 283.27 C 413.22 281.9 412.63 280.93 411.75 280.67 C 411.04 280.46 410.31 280.73 409.83 281.37 C 409.4 281.95 408.68 282.23 407.97 282.13 C 407.26 282.03 406.66 281.54 406.42 280.86 C 405.94 279.52 405.25 278.4 404.38 277.53 C 403.59 276.76 401.78 275.32 399.23 275.32 C 398.33 275.32 397.34 275.49 396.27 275.94 C 393.96 276.9 392.08 279.79 392.08 282.37 C 392.08 282.67 392.1 282.96 392.14 283.25 C 392.26 284.23 391.63 285.15 390.67 285.39 C 389.1 285.79 387.22 286.86 387.22 289.74 C 387.22 292.08 388.52 293.37 389.6 294.03 C 389.86 294.19 390.17 294.28 390.49 294.28 L 415.14 294.3 L 415.15 294.3 C 415.91 294.3 419.72 294.04 419.72 289.59 Z M 388.17 282.11 C 388.29 278.03 391.08 273.86 394.76 272.33 C 396.14 271.75 397.54 271.48 398.92 271.44 L 396.39 252.6 L 396.39 252.6 C 396.39 252.6 396.39 252.59 396.39 252.59 L 396.32 252.11 C 396.31 252.02 396.31 251.94 396.31 251.85 C 396.31 249.16 399.11 246.95 403.3 245.34 L 403.15 245.34 L 403.15 217.93 C 403.15 216.85 402.28 215.97 401.2 215.97 L 369.87 215.97 C 368.79 215.97 367.92 216.85 367.92 217.93 L 367.92 286.45 C 367.92 287.53 368.79 288.4 369.87 288.4 L 383.4 288.4 C 383.79 285.51 385.49 283.28 388.17 282.11 Z M 390.49 298.19 C 389.44 298.19 388.43 297.91 387.55 297.37 C 386.32 296.61 384.45 295.04 383.67 292.32 L 375.75 292.32 L 375.75 298.19 L 371.83 298.19 L 371.83 292.32 L 369.87 292.32 C 366.63 292.32 364 289.69 364 286.45 L 364 217.93 C 364 214.69 366.63 212.06 369.87 212.06 L 401.2 212.06 C 404.43 212.06 407.07 214.69 407.07 217.93 L 407.07 244.14 C 411.44 243 416.64 242.37 421.67 242.37 C 433.87 242.37 447.05 246 447.05 251.85 C 447.05 251.94 447.04 252.02 447.03 252.11 L 446.97 252.59 C 446.96 252.67 446.94 252.75 446.92 252.83 C 446.91 252.85 446.9 252.86 446.9 252.88 L 444.87 267.91 C 448.19 269.84 449.78 271.4 450.09 273.01 C 450.25 273.89 450.02 274.75 449.45 275.43 C 448.78 276.23 447.78 276.62 446.32 276.62 C 445.58 276.62 444.72 276.51 443.74 276.32 L 441.73 291.28 C 441.65 293.14 440.11 294.67 437.15 295.84 C 436.07 296.27 434.82 296.65 433.43 296.97 C 430 297.76 425.83 298.19 421.67 298.19 L 415.16 298.19 Z M 375.75 245.34 L 397.28 245.34 L 397.28 241.42 L 375.75 241.42 Z M 375.75 255.13 L 391.41 255.13 L 391.41 251.21 L 375.75 251.21 Z M 375.75 235.55 L 397.28 235.55 L 397.28 231.63 L 375.75 231.63 Z" fill="#3333ff" stroke="none" pointer-events="all"/><rect x="419" y="172" width="52" height="52" fill="none" stroke="none" pointer-events="all"/><path d="M 425 209.72 C 424.27 208.48 423.66 207.16 423.19 205.81 L 425.42 205.02 C 425.85 206.24 426.39 207.41 427.04 208.53 Z M 425.04 192.81 L 422.77 192.16 C 423.28 190.37 424.01 188.64 424.94 187.03 L 426.99 188.21 C 426.15 189.66 425.5 191.2 425.04 192.81 Z M 436.24 179.86 L 435.27 177.7 C 441.1 175.08 447.93 175.08 453.76 177.7 L 452.79 179.86 C 447.52 177.52 441.51 177.52 436.24 179.86 Z M 462.04 188.21 L 464.08 187.03 C 465.02 188.64 465.75 190.37 466.26 192.16 L 463.98 192.8 C 463.53 191.2 462.87 189.65 462.04 188.21 Z M 463.61 205.02 L 465.84 205.81 C 465.38 207.12 464.78 208.41 464.08 209.62 L 462.04 208.44 C 462.67 207.35 463.19 206.2 463.61 205.02 Z M 452.79 216.79 L 453.76 218.95 C 450.84 220.25 447.73 220.92 444.51 220.92 C 441.3 220.92 438.18 220.25 435.27 218.95 L 436.24 216.79 C 441.45 219.13 447.57 219.13 452.79 216.79 Z M 430.23 217.23 C 428.6 217.23 427.27 215.91 427.27 214.28 C 427.27 212.65 428.6 211.32 430.23 211.32 C 431.86 211.32 433.18 212.65 433.18 214.28 C 433.18 215.91 431.86 217.23 430.23 217.23 Z M 430.23 208.96 C 427.29 208.96 424.91 211.35 424.91 214.28 C 424.91 217.21 427.29 219.6 430.23 219.6 C 433.16 219.6 435.55 217.21 435.55 214.28 C 435.55 211.34 433.16 208.96 430.23 208.96 Z M 458.59 217.23 C 456.96 217.23 455.64 215.91 455.64 214.28 C 455.64 212.65 456.96 211.32 458.59 211.32 C 460.22 211.32 461.55 212.65 461.55 214.28 C 461.55 215.91 460.22 217.23 458.59 217.23 Z M 458.59 208.96 C 455.66 208.96 453.27 211.35 453.27 214.28 C 453.27 217.21 455.66 219.6 458.59 219.6 C 461.52 219.6 463.91 217.21 463.91 214.28 C 463.91 211.34 461.52 208.96 458.59 208.96 Z M 421.36 198.91 C 421.36 197.29 422.69 195.96 424.32 195.96 C 425.95 195.96 427.27 197.29 427.27 198.91 C 427.27 200.54 425.95 201.87 424.32 201.87 C 422.69 201.87 421.36 200.54 421.36 198.91 Z M 429.58 199.5 L 433.34 199.5 L 432.2 201.21 L 434.16 202.53 L 436.53 199 C 436.79 198.6 436.79 198.08 436.53 197.69 L 434.17 194.12 L 432.2 195.43 L 433.33 197.14 L 429.31 197.14 C 428.58 195.08 426.63 193.6 424.32 193.6 C 421.38 193.6 419 195.98 419 198.91 C 419 201.85 421.38 204.23 424.32 204.23 C 427.05 204.23 429.28 202.16 429.58 199.5 Z M 465.68 201.87 C 464.05 201.87 462.73 200.54 462.73 198.91 C 462.73 197.28 464.05 195.96 465.68 195.96 C 467.31 195.96 468.64 197.29 468.64 198.91 C 468.64 200.54 467.31 201.87 465.68 201.87 Z M 465.68 193.6 C 462.75 193.6 460.36 195.98 460.36 198.91 C 460.36 201.85 462.75 204.23 465.68 204.23 C 468.62 204.23 471 201.85 471 198.91 C 471 195.98 468.61 193.6 465.68 193.6 Z M 430.23 179.41 C 431.86 179.41 433.18 180.74 433.18 182.37 C 433.18 184 431.86 185.32 430.23 185.32 C 428.6 185.32 427.27 184 427.27 182.37 C 427.27 180.74 428.6 179.41 430.23 179.41 Z M 430.23 187.69 C 433.16 187.69 435.55 185.3 435.55 182.37 C 435.55 179.43 433.16 177.05 430.23 177.05 C 427.3 177.05 424.91 179.44 424.91 182.37 C 424.91 185.3 427.29 187.69 430.23 187.69 Z M 458.59 179.41 C 460.22 179.41 461.55 180.74 461.55 182.37 C 461.55 184 460.22 185.32 458.59 185.32 C 456.96 185.32 455.64 184 455.64 182.37 C 455.64 180.74 456.96 179.41 458.59 179.41 Z M 458.59 187.69 C 461.52 187.69 463.91 185.3 463.91 182.37 C 463.91 179.43 461.52 177.05 458.59 177.05 C 455.66 177.05 453.27 179.44 453.27 182.37 C 453.27 185.3 455.66 187.69 458.59 187.69 Z M 454.65 201.21 L 455.79 199.51 L 453.27 199.51 L 453.27 197.14 L 455.79 197.14 L 454.65 195.43 L 456.62 194.12 L 458.98 197.67 C 459.25 198.06 459.25 198.58 458.98 198.98 L 456.62 202.52 Z M 449.95 203.29 C 448.36 202.77 446.68 202.5 445 202.51 C 443.3 202.51 441.6 202.77 440.05 203.29 C 440.57 201.79 440.84 200.1 440.84 198.32 C 440.84 196.55 440.57 194.86 440.05 193.35 C 443.15 194.4 446.86 194.4 449.95 193.35 C 449.44 194.86 449.16 196.55 449.16 198.32 C 449.16 200.1 449.44 201.79 449.95 203.29 Z M 454.12 190.88 C 454.35 190.65 454.47 190.35 454.47 190.04 C 454.47 189.74 454.35 189.44 454.12 189.21 C 453.66 188.75 452.91 188.75 452.45 189.21 C 448.97 192.69 441.04 192.69 437.56 189.21 C 437.1 188.75 436.35 188.75 435.89 189.21 C 435.66 189.44 435.54 189.74 435.54 190.04 C 435.54 190.35 435.66 190.65 435.89 190.88 C 437.51 192.5 438.48 195.28 438.48 198.32 C 438.48 201.36 437.51 204.15 435.89 205.77 C 435.66 205.99 435.54 206.29 435.54 206.6 C 435.54 206.91 435.66 207.21 435.89 207.44 C 436.35 207.9 437.1 207.9 437.56 207.44 C 441.04 203.96 448.97 203.96 452.45 207.44 C 452.68 207.67 452.98 207.79 453.28 207.79 C 453.59 207.79 453.89 207.67 454.12 207.44 C 454.35 207.21 454.47 206.91 454.47 206.6 C 454.47 206.29 454.34 205.99 454.12 205.77 C 452.5 204.15 451.53 201.36 451.53 198.32 C 451.53 195.28 452.5 192.5 454.12 190.88 Z" fill="#0050ef" stroke="none" pointer-events="all"/><ellipse cx="17" cy="132" rx="7" ry="7" fill="#3333ff" stroke="#3333ff" pointer-events="all"/><path d="M 20 122 Q 30 122 30 132 Q 30 142 20 142" fill="none" stroke="#3333ff" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="467" cy="80.75" rx="5" ry="5" fill="#3333ff" stroke="#3333ff" pointer-events="all"/><path d="M 467 85.75 L 467 102.42 M 467 89.08 L 457 89.08 M 467 89.08 L 477 89.08 M 467 102.42 L 457 115.75 M 467 102.42 L 477 115.75" fill="none" stroke="#3333ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 467 115.75 L 467 192" fill="none" stroke="#3333ff" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><ellipse cx="451" cy="20.25" rx="5" ry="5" fill="#3333ff" stroke="#3333ff" pointer-events="all"/><path d="M 451 25.25 L 451 41.92 M 451 28.58 L 441 28.58 M 451 28.58 L 461 28.58 M 451 41.92 L 441 55.25 M 451 41.92 L 461 55.25" fill="none" stroke="#3333ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 451 55.25 L 451 170" fill="none" stroke="#3333ff" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><rect x="485" y="125" width="187" height="52" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 185px; height: 1px; padding-top: 151px; margin-left: 487px;"><div data-drawio-colors="color: #3333FF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 8px; font-family: Helvetica; color: rgb(51, 51, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 11px;"><font color="#000000">(3) A </font><b>broker</b><font color="#000000">-like agent fetches </font><i style="color: rgb(0, 0, 0);">resource</i><font color="#000000"> and </font><i style="color: rgb(0, 0, 0);">statement</i><font color="#000000"> information from the central store on request, e.g., by the central authorization point (CEP).   </font></span></div></div></div></foreignObject><text x="487" y="153" fill="#3333FF" font-family="Helvetica" font-size="8px">(3) A broker-like agent fetches resource and s...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>


(II) Policy-Based Access Model **(PBA\M)**

The PBA\M **is the interface for access assignment. Its infrastructure defines the policy model, access assignment strategies, and method of assuming a policy’s authorization. 

- The policy is an account-scoped object that defines access statements and principle requirements. The policy:statements are a collection of simple **************resource-based (via RAD) access grants.
- The policy:principles are the set of users who have been assigned permission to assume some policy. The policy:requirements dictate an optional set of *just-in-time* conditions a principle must meet to assume it e.g., ip:address.

The PBA model is similar to a subset of AWS IAM in that principles are given permission to assume an *AuthorizationPolicy* and **the *Principle* assuming that policy is allowed to execute all accesses defined by it and only it. It is evaluated at the centralized enforcement point (CEP). The model decouples authorization from authentication; and consolidates different access strategies for e.g., account vs user scopes, in the Platform. 

- (II.1) *Resource Policies* (*p* is granted *s:r*) are persisted with a uniform policy schema in a single store.
- (II.2) *Resource Policies* (*p* is granted *s:r*) are simple, fine-grained, and bound to the resource universe.
- (II.3) *Resource Policies (p* is granted *s:r*) are defined within a specification language format.
- (II.4) *Resource Policies* (*p* is granted *s:r*) are decoupled from credential items (e.g., users, tokens).
- (II.5) *Resource Policies* (*p* is granted *s:r*) are dynamic and have immediate effect.
- (II.6) *Resource Policies* (*p* is granted *s:r*) are revokable.
- (II.7) *Resource Policies* (*p* is granted *s:r*) are auditable.

![Uploading ac<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="666px" height="438px" viewBox="-0.5 -0.5 666 438" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="331.95" y="163" width="89.65" height="77" fill="none" stroke="none" pointer-events="all"/><path d="M 386.02 217.49 C 386.02 218.87 387.13 219.98 388.51 219.98 C 389.89 219.98 391 218.87 391 217.49 C 391 216.12 389.89 215 388.51 215 C 387.13 215 386.02 216.12 386.02 217.49 Z M 412.22 216.86 L 410.86 216.86 C 410.37 216.86 409.9 216.68 409.53 216.37 L 408.71 215.65 L 407.88 216.37 C 407.51 216.68 407.04 216.86 406.55 216.86 L 405.11 216.86 C 404.62 216.86 404.15 216.68 403.78 216.37 L 402.96 215.65 L 402.12 216.37 C 401.76 216.68 401.28 216.86 400.8 216.86 L 398.25 216.86 C 397.38 216.86 396.61 216.32 396.33 215.5 C 395.5 213.16 393.05 211.52 390.38 211.52 C 386.94 211.52 384.14 214.2 384.14 217.49 C 384.14 220.78 386.94 223.46 390.38 223.46 C 393.05 223.46 395.5 221.82 396.33 219.48 C 396.61 218.67 397.38 218.12 398.25 218.12 L 412.77 218.12 L 413.12 217.69 Z M 415.32 221.44 C 414.93 221.91 414.35 222.19 413.74 222.19 L 399.56 222.19 C 397.81 225.39 394.23 227.53 390.38 227.53 C 384.7 227.53 380.07 223.03 380.07 217.49 C 380.07 211.96 384.7 207.45 390.38 207.45 C 394.23 207.45 397.81 209.59 399.56 212.79 L 400.04 212.79 L 401.63 211.43 C 402.39 210.77 403.52 210.77 404.28 211.43 L 405.83 212.76 L 407.38 211.43 C 408.14 210.77 409.27 210.77 410.03 211.43 L 411.62 212.79 L 413.02 212.79 C 413.53 212.79 414.03 212.98 414.4 213.33 L 417.28 216 C 417.33 216.04 417.35 216.11 417.39 216.15 C 417.14 205.73 408.6 197.32 398.11 197.32 C 387.47 197.32 378.81 205.98 378.81 216.63 C 378.81 227.27 387.47 235.93 398.11 235.93 C 407.93 235.93 416.05 228.55 417.25 219.05 Z M 398.11 240 C 385.22 240 374.74 229.52 374.74 216.63 C 374.74 203.74 385.22 193.25 398.11 193.25 C 411 193.25 421.49 203.74 421.49 216.63 C 421.49 229.52 411 240 398.11 240 Z M 345.67 225.12 C 346.05 225.52 346.58 225.75 347.14 225.75 C 347.69 225.75 348.23 225.52 348.61 225.12 L 360.47 212.67 L 357.52 209.87 L 347.14 220.76 L 342.68 216.09 L 339.74 218.89 Z M 344.43 205.59 L 349.21 200.81 L 354 205.59 L 356.87 202.72 L 352.09 197.93 L 356.87 193.15 L 354 190.27 L 349.21 195.05 L 344.43 190.27 L 341.55 193.15 L 346.33 197.93 L 341.55 202.72 Z M 344.43 186.03 L 349.21 181.25 L 354 186.03 L 356.87 183.16 L 352.09 178.37 L 356.87 173.59 L 354 170.71 L 349.21 175.49 L 344.43 170.71 L 341.55 173.59 L 346.33 178.37 L 341.55 183.16 Z M 374.52 227.01 L 374.52 231.08 L 336.44 231.08 C 334.03 231.08 332.06 229.12 332.06 226.7 L 332.06 167.38 C 332.06 164.97 334.03 163 336.44 163 L 379.76 163 C 382.18 163 384.14 164.97 384.14 167.38 L 384.14 195.28 L 380.07 195.28 L 380.07 167.38 C 380.07 167.21 379.94 167.07 379.76 167.07 L 336.44 167.07 C 336.27 167.07 336.13 167.21 336.13 167.38 L 336.13 226.7 C 336.13 226.88 336.27 227.01 336.44 227.01 Z" fill="#ff0000" stroke="none" pointer-events="all"/><rect x="76" y="152" width="99" height="88" fill="none" stroke="none" pointer-events="all"/><path d="M 115.74 208.25 L 115.74 209.48 L 135.33 209.48 L 135.33 208.25 Z M 115.74 200.86 L 115.74 202.08 L 117.97 202.08 C 115.92 203.4 113.7 205.7 112.62 207.82 C 112.37 207.04 112.15 206.65 111.8 206.19 C 111.49 205.86 110.96 205.86 110.78 205.98 C 110.37 206.25 110.15 206.5 110.02 206.72 C 111.17 207.34 111.52 208.87 112.01 210.23 C 112.25 209.83 112.97 209.25 113.48 209.17 C 114.21 207.13 117.09 203.47 119.01 202.08 L 135.33 202.08 L 135.33 200.86 Z M 115.74 193.46 L 115.74 194.7 L 117.93 194.7 C 115.89 196.01 113.69 198.29 112.62 200.4 C 112.37 199.62 112.15 199.23 111.8 198.77 C 111.49 198.44 110.96 198.44 110.78 198.56 C 110.37 198.83 110.15 199.08 110.02 199.29 C 111.17 199.92 111.52 201.44 112.01 202.81 C 112.25 202.4 112.97 201.83 113.48 201.75 C 114.21 199.72 117.06 196.1 118.98 194.7 L 135.33 194.7 L 135.33 193.46 Z M 118.91 186.7 C 116.63 187.83 113.87 190.53 112.62 192.98 C 112.37 192.2 112.15 191.8 111.8 191.34 C 111.49 191.02 110.96 191.02 110.78 191.14 C 110.37 191.41 110.15 191.65 110.02 191.87 C 111.17 192.5 111.52 194.02 112.01 195.39 C 112.25 194.98 112.97 194.41 113.48 194.33 C 114.24 192.21 117.34 188.29 119.25 187.06 C 119.19 186.91 119.05 186.77 118.91 186.7 Z M 107.85 172.73 C 106.21 172.73 104.85 174.14 104.85 175.82 L 104.85 220.13 C 104.85 221.8 106.21 223.21 107.85 223.21 L 143.15 223.21 C 144.79 223.21 146.15 221.8 146.15 220.13 L 146.15 175.82 C 146.15 174.14 144.79 172.73 143.15 172.73 L 134.35 172.73 L 134.35 174.39 C 134.35 175.73 135.1 176.42 137.01 176.42 L 141 176.42 C 142.09 176.42 142.56 177.16 142.56 178.16 L 142.56 217.52 C 142.56 218.89 141.82 219.51 140.63 219.51 L 110.25 219.51 C 109.04 219.51 108.44 218.93 108.44 217.41 L 108.44 178.2 C 108.44 176.92 109.02 176.42 110.14 176.42 L 114.55 176.42 C 115.71 176.42 116.62 175.6 116.62 174.47 L 116.62 172.73 Z M 125.19 172.67 C 126.13 172.67 126.91 173.45 126.91 174.42 C 126.91 175.39 126.13 176.19 125.19 176.19 C 124.25 176.19 123.49 175.39 123.49 174.42 C 123.49 173.45 124.25 172.67 125.19 172.67 Z M 125.35 168.8 C 122.05 168.8 119.87 171.44 119.87 174.66 L 119.87 177.03 C 119.87 178.36 118.95 178.96 117.56 179.37 C 115.11 179.98 114.06 181.73 113.98 184.3 L 136.8 184.34 C 136.6 181.86 135.74 180.03 132.84 179.24 C 131.68 178.9 130.84 178.01 130.84 177 L 130.85 174.4 C 130.85 171.91 128.98 168.8 125.35 168.8 Z M 100.49 240 L 76 195.83 L 100.41 152 L 150.53 152 L 175 195.83 L 150.52 240 Z" fill="#990000" stroke="none" pointer-events="all"/><rect x="76.99" y="152.88" width="97.02" height="86.24" fill="none" stroke="none" pointer-events="all"/><path d="M 100.99 239.12 L 76.99 195.83 L 100.92 152.88 L 150.03 152.88 L 174.01 195.83 L 150.02 239.12 Z" fill="#ffffff" stroke="none" pointer-events="all"/><rect x="76" y="152" width="99" height="88" fill="none" stroke="none" pointer-events="all"/><path d="M 115.74 208.25 L 115.74 209.48 L 135.33 209.48 L 135.33 208.25 Z M 115.74 200.86 L 115.74 202.08 L 117.97 202.08 C 115.92 203.4 113.7 205.7 112.62 207.82 C 112.37 207.04 112.15 206.65 111.8 206.19 C 111.49 205.86 110.96 205.86 110.78 205.98 C 110.37 206.25 110.15 206.5 110.02 206.72 C 111.17 207.34 111.52 208.87 112.01 210.23 C 112.25 209.83 112.97 209.25 113.48 209.17 C 114.21 207.13 117.09 203.47 119.01 202.08 L 135.33 202.08 L 135.33 200.86 Z M 115.74 193.46 L 115.74 194.7 L 117.93 194.7 C 115.89 196.01 113.69 198.29 112.62 200.4 C 112.37 199.62 112.15 199.23 111.8 198.77 C 111.49 198.44 110.96 198.44 110.78 198.56 C 110.37 198.83 110.15 199.08 110.02 199.29 C 111.17 199.92 111.52 201.44 112.01 202.81 C 112.25 202.4 112.97 201.83 113.48 201.75 C 114.21 199.72 117.06 196.1 118.98 194.7 L 135.33 194.7 L 135.33 193.46 Z M 118.91 186.7 C 116.63 187.83 113.87 190.53 112.62 192.98 C 112.37 192.2 112.15 191.8 111.8 191.34 C 111.49 191.02 110.96 191.02 110.78 191.14 C 110.37 191.41 110.15 191.65 110.02 191.87 C 111.17 192.5 111.52 194.02 112.01 195.39 C 112.25 194.98 112.97 194.41 113.48 194.33 C 114.24 192.21 117.34 188.29 119.25 187.06 C 119.19 186.91 119.05 186.77 118.91 186.7 Z M 107.85 172.73 C 106.21 172.73 104.85 174.14 104.85 175.82 L 104.85 220.13 C 104.85 221.8 106.21 223.21 107.85 223.21 L 143.15 223.21 C 144.79 223.21 146.15 221.8 146.15 220.13 L 146.15 175.82 C 146.15 174.14 144.79 172.73 143.15 172.73 L 134.35 172.73 L 134.35 174.39 C 134.35 175.73 135.1 176.42 137.01 176.42 L 141 176.42 C 142.09 176.42 142.56 177.16 142.56 178.16 L 142.56 217.52 C 142.56 218.89 141.82 219.51 140.63 219.51 L 110.25 219.51 C 109.04 219.51 108.44 218.93 108.44 217.41 L 108.44 178.2 C 108.44 176.92 109.02 176.42 110.14 176.42 L 114.55 176.42 C 115.71 176.42 116.62 175.6 116.62 174.47 L 116.62 172.73 Z M 125.19 172.67 C 126.13 172.67 126.91 173.45 126.91 174.42 C 126.91 175.39 126.13 176.19 125.19 176.19 C 124.25 176.19 123.49 175.39 123.49 174.42 C 123.49 173.45 124.25 172.67 125.19 172.67 Z M 125.35 168.8 C 122.05 168.8 119.87 171.44 119.87 174.66 L 119.87 177.03 C 119.87 178.36 118.95 178.96 117.56 179.37 C 115.11 179.98 114.06 181.73 113.98 184.3 L 136.8 184.34 C 136.6 181.86 135.74 180.03 132.84 179.24 C 131.68 178.9 130.84 178.01 130.84 177 L 130.85 174.4 C 130.85 171.91 128.98 168.8 125.35 168.8 Z M 100.49 240 L 76 195.83 L 100.41 152 L 150.53 152 L 175 195.83 L 150.52 240 Z" fill="#990000" stroke="none" pointer-events="all"/><rect x="84" y="156" width="99" height="88" fill="none" stroke="none" pointer-events="all"/><path d="M 123.74 212.25 L 123.74 213.48 L 143.33 213.48 L 143.33 212.25 Z M 123.74 204.86 L 123.74 206.08 L 125.97 206.08 C 123.92 207.4 121.7 209.7 120.62 211.82 C 120.37 211.04 120.15 210.65 119.8 210.19 C 119.49 209.86 118.96 209.86 118.78 209.98 C 118.37 210.25 118.15 210.5 118.02 210.72 C 119.17 211.34 119.52 212.87 120.01 214.23 C 120.25 213.83 120.97 213.25 121.48 213.17 C 122.21 211.13 125.09 207.47 127.01 206.08 L 143.33 206.08 L 143.33 204.86 Z M 123.74 197.46 L 123.74 198.7 L 125.93 198.7 C 123.89 200.01 121.69 202.29 120.62 204.4 C 120.37 203.62 120.15 203.23 119.8 202.77 C 119.49 202.44 118.96 202.44 118.78 202.56 C 118.37 202.83 118.15 203.08 118.02 203.29 C 119.17 203.92 119.52 205.44 120.01 206.81 C 120.25 206.4 120.97 205.83 121.48 205.75 C 122.21 203.72 125.06 200.1 126.98 198.7 L 143.33 198.7 L 143.33 197.46 Z M 126.91 190.7 C 124.63 191.83 121.87 194.53 120.62 196.98 C 120.37 196.2 120.15 195.8 119.8 195.34 C 119.49 195.02 118.96 195.02 118.78 195.14 C 118.37 195.41 118.15 195.65 118.02 195.87 C 119.17 196.5 119.52 198.02 120.01 199.39 C 120.25 198.98 120.97 198.41 121.48 198.33 C 122.24 196.21 125.34 192.29 127.25 191.06 C 127.19 190.91 127.05 190.77 126.91 190.7 Z M 115.85 176.73 C 114.21 176.73 112.85 178.14 112.85 179.82 L 112.85 224.13 C 112.85 225.8 114.21 227.21 115.85 227.21 L 151.15 227.21 C 152.79 227.21 154.15 225.8 154.15 224.13 L 154.15 179.82 C 154.15 178.14 152.79 176.73 151.15 176.73 L 142.35 176.73 L 142.35 178.39 C 142.35 179.73 143.1 180.42 145.01 180.42 L 149 180.42 C 150.09 180.42 150.56 181.16 150.56 182.16 L 150.56 221.52 C 150.56 222.89 149.82 223.51 148.63 223.51 L 118.25 223.51 C 117.04 223.51 116.44 222.93 116.44 221.41 L 116.44 182.2 C 116.44 180.92 117.02 180.42 118.14 180.42 L 122.55 180.42 C 123.71 180.42 124.62 179.6 124.62 178.47 L 124.62 176.73 Z M 133.19 176.67 C 134.13 176.67 134.91 177.45 134.91 178.42 C 134.91 179.39 134.13 180.19 133.19 180.19 C 132.25 180.19 131.49 179.39 131.49 178.42 C 131.49 177.45 132.25 176.67 133.19 176.67 Z M 133.35 172.8 C 130.05 172.8 127.87 175.44 127.87 178.66 L 127.87 181.03 C 127.87 182.36 126.95 182.96 125.56 183.37 C 123.11 183.98 122.06 185.73 121.98 188.3 L 144.8 188.34 C 144.6 185.86 143.74 184.03 140.84 183.24 C 139.68 182.9 138.84 182.01 138.84 181 L 138.85 178.4 C 138.85 175.91 136.98 172.8 133.35 172.8 Z M 108.49 244 L 84 199.83 L 108.41 156 L 158.53 156 L 183 199.83 L 158.52 244 Z" fill="#ff0000" stroke="none" pointer-events="all"/><rect x="84.99" y="156.88" width="97.02" height="86.24" fill="none" stroke="none" pointer-events="all"/><path d="M 108.99 243.12 L 84.99 199.83 L 108.92 156.88 L 158.03 156.88 L 182.01 199.83 L 158.02 243.12 Z" fill="#ffffff" stroke="none" pointer-events="all"/><rect x="84" y="156" width="99" height="88" fill="none" stroke="none" pointer-events="all"/><path d="M 123.74 212.25 L 123.74 213.48 L 143.33 213.48 L 143.33 212.25 Z M 123.74 204.86 L 123.74 206.08 L 125.97 206.08 C 123.92 207.4 121.7 209.7 120.62 211.82 C 120.37 211.04 120.15 210.65 119.8 210.19 C 119.49 209.86 118.96 209.86 118.78 209.98 C 118.37 210.25 118.15 210.5 118.02 210.72 C 119.17 211.34 119.52 212.87 120.01 214.23 C 120.25 213.83 120.97 213.25 121.48 213.17 C 122.21 211.13 125.09 207.47 127.01 206.08 L 143.33 206.08 L 143.33 204.86 Z M 123.74 197.46 L 123.74 198.7 L 125.93 198.7 C 123.89 200.01 121.69 202.29 120.62 204.4 C 120.37 203.62 120.15 203.23 119.8 202.77 C 119.49 202.44 118.96 202.44 118.78 202.56 C 118.37 202.83 118.15 203.08 118.02 203.29 C 119.17 203.92 119.52 205.44 120.01 206.81 C 120.25 206.4 120.97 205.83 121.48 205.75 C 122.21 203.72 125.06 200.1 126.98 198.7 L 143.33 198.7 L 143.33 197.46 Z M 126.91 190.7 C 124.63 191.83 121.87 194.53 120.62 196.98 C 120.37 196.2 120.15 195.8 119.8 195.34 C 119.49 195.02 118.96 195.02 118.78 195.14 C 118.37 195.41 118.15 195.65 118.02 195.87 C 119.17 196.5 119.52 198.02 120.01 199.39 C 120.25 198.98 120.97 198.41 121.48 198.33 C 122.24 196.21 125.34 192.29 127.25 191.06 C 127.19 190.91 127.05 190.77 126.91 190.7 Z M 115.85 176.73 C 114.21 176.73 112.85 178.14 112.85 179.82 L 112.85 224.13 C 112.85 225.8 114.21 227.21 115.85 227.21 L 151.15 227.21 C 152.79 227.21 154.15 225.8 154.15 224.13 L 154.15 179.82 C 154.15 178.14 152.79 176.73 151.15 176.73 L 142.35 176.73 L 142.35 178.39 C 142.35 179.73 143.1 180.42 145.01 180.42 L 149 180.42 C 150.09 180.42 150.56 181.16 150.56 182.16 L 150.56 221.52 C 150.56 222.89 149.82 223.51 148.63 223.51 L 118.25 223.51 C 117.04 223.51 116.44 222.93 116.44 221.41 L 116.44 182.2 C 116.44 180.92 117.02 180.42 118.14 180.42 L 122.55 180.42 C 123.71 180.42 124.62 179.6 124.62 178.47 L 124.62 176.73 Z M 133.19 176.67 C 134.13 176.67 134.91 177.45 134.91 178.42 C 134.91 179.39 134.13 180.19 133.19 180.19 C 132.25 180.19 131.49 179.39 131.49 178.42 C 131.49 177.45 132.25 176.67 133.19 176.67 Z M 133.35 172.8 C 130.05 172.8 127.87 175.44 127.87 178.66 L 127.87 181.03 C 127.87 182.36 126.95 182.96 125.56 183.37 C 123.11 183.98 122.06 185.73 121.98 188.3 L 144.8 188.34 C 144.6 185.86 143.74 184.03 140.84 183.24 C 139.68 182.9 138.84 182.01 138.84 181 L 138.85 178.4 C 138.85 175.91 136.98 172.8 133.35 172.8 Z M 108.49 244 L 84 199.83 L 108.41 156 L 158.53 156 L 183 199.83 L 158.52 244 Z" fill="#ff0000" stroke="none" pointer-events="all"/><ellipse cx="361.97" cy="378" rx="35.015" ry="32.5" fill="rgb(255, 255, 255)" stroke="#ff0000" stroke-width="3" pointer-events="all"/><path d="M 333.95 397.5 C 335.87 393.12 343.95 389.91 353.56 389.7 C 354.18 389.8 354.81 389.63 355.28 389.26 C 355.75 388.88 356.02 388.33 356.01 387.75 C 356.49 383.6 354.8 379.49 351.46 376.7 C 350.61 376.7 349.92 375.1 349.92 373.13 C 349.92 371.15 350.61 369.55 351.46 369.55 C 351.07 366.68 351.98 363.8 353.97 361.58 C 355.96 359.36 358.86 358.01 361.97 357.85 C 365.07 358.01 367.97 359.36 369.96 361.58 C 371.95 363.8 372.86 366.68 372.47 369.55 C 373.32 369.55 374.01 371.15 374.01 373.13 C 374.01 375.1 373.32 376.7 372.47 376.7 C 369.13 379.49 367.44 383.6 367.92 387.75 C 367.91 388.33 368.18 388.88 368.65 389.26 C 369.12 389.63 369.75 389.8 370.37 389.7 C 379.98 389.91 388.06 393.12 389.98 397.5" fill="none" stroke="#ff0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 183.1 227.64 L 213.1 227.64 L 288 372 L 318 372" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 187.1 223.64 L 187.1 231.64 M 191.1 223.64 L 191.1 231.64" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="306" cy="372" rx="3" ry="3" fill="#ffffff" stroke="#ff0000" pointer-events="all"/><path d="M 318 368 L 310 372 L 318 376" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><rect x="331.95" y="20" width="78" height="78" fill="none" stroke="none" pointer-events="all"/><path d="M 369.18 20 L 369.18 23.55 L 406.4 23.55 L 406.4 44.82 L 374.5 44.82 L 374.5 48.36 L 406.4 48.36 L 406.4 69.64 L 335.5 69.64 L 335.5 57.23 L 331.95 57.23 L 331.95 69.64 L 331.95 71.41 L 331.95 98 L 409.95 98 L 409.95 71.41 L 409.95 69.64 L 409.95 46.59 L 409.95 44.82 L 409.95 20 Z M 335.5 94.45 L 335.5 73.18 L 406.4 73.18 L 406.4 94.45 Z M 401.2 31.13 L 391.74 40.59 L 384.74 35.63 L 386.79 32.74 L 391.35 35.97 L 398.7 28.63 Z M 401.2 55.95 L 391.74 65.41 L 384.74 60.45 L 386.79 57.56 L 391.35 60.79 L 398.7 53.45 Z M 386.18 88.1 L 390.35 83.93 L 386.18 79.76 L 388.69 77.25 L 392.86 81.42 L 397.03 77.25 L 399.54 79.76 L 395.37 83.93 L 399.54 88.1 L 397.03 90.61 L 392.86 86.43 L 388.69 90.61 Z M 334.77 45.52 L 336.49 45.52 C 336.64 45.89 336.81 46.23 337 46.58 L 335.82 47.78 C 334.86 48.74 334.86 50.32 335.82 51.29 L 339.91 55.42 C 340.85 56.37 342.51 56.37 343.45 55.42 L 344.63 54.23 C 344.99 54.42 345.35 54.59 345.75 54.75 L 345.75 56.5 C 345.75 57.88 346.87 59 348.24 59 L 354.66 59 C 356.03 59 357.15 57.88 357.15 56.5 L 357.15 54.75 C 357.53 54.59 357.87 54.42 358.21 54.24 L 359.4 55.43 C 360.38 56.39 361.96 56.39 362.92 55.42 L 367.04 51.33 C 367.52 50.85 367.78 50.23 367.78 49.55 C 367.78 48.88 367.52 48.25 367.04 47.78 L 365.87 46.61 C 366.05 46.27 366.22 45.91 366.38 45.52 L 368.13 45.52 C 369.51 45.52 370.63 44.4 370.63 43.03 L 370.63 36.61 C 370.63 35.24 369.51 34.12 368.13 34.12 L 366.22 34.12 C 366.07 33.73 365.9 33.37 365.72 33.02 L 366.89 31.83 C 367.85 30.87 367.85 29.29 366.89 28.32 L 362.85 24.23 C 361.9 23.26 360.23 23.27 359.29 24.23 L 358.16 25.37 C 357.84 25.2 357.51 25.04 357.15 24.89 L 357.15 23.14 C 357.15 21.76 356.03 20.64 354.66 20.64 L 348.24 20.64 C 346.87 20.64 345.75 21.76 345.75 23.14 L 345.75 24.83 C 345.38 24.98 345.03 25.15 344.69 25.33 L 343.5 24.15 C 342.53 23.18 340.95 23.18 339.97 24.15 L 335.85 28.25 C 335.38 28.72 335.11 29.35 335.11 30.02 C 335.11 30.69 335.38 31.32 335.85 31.79 L 337.04 32.97 C 336.85 33.34 336.68 33.71 336.51 34.12 L 334.77 34.12 C 333.39 34.12 332.27 35.24 332.27 36.61 L 332.27 43.03 C 332.27 44.4 333.39 45.52 334.77 45.52 Z M 335.81 37.66 L 339.15 37.66 L 339.51 36.34 C 339.78 35.29 340.22 34.49 340.77 33.56 L 341.46 32.38 L 339.1 30.02 L 341.74 27.4 L 343.14 28.79 L 344.25 29.67 L 345.43 28.98 C 346.39 28.43 347.02 28.06 347.97 27.81 L 349.29 27.46 L 349.29 24.18 L 353.61 24.18 L 353.61 27.51 L 354.92 27.86 C 355.85 28.11 356.47 28.48 357.56 29.12 L 358.75 29.82 L 361.07 27.47 L 363.64 30.08 L 361.32 32.44 L 361.99 33.61 C 362.61 34.7 362.98 35.36 363.23 36.34 L 363.58 37.66 L 367.09 37.66 L 367.09 41.98 L 363.74 41.98 L 363.39 43.3 C 363.13 44.28 362.74 44.97 362.13 46.02 L 361.43 47.2 L 363.8 49.55 L 361.16 52.17 L 358.79 49.82 L 357.43 50.61 C 356.49 51.15 355.87 51.52 354.93 51.76 L 353.61 52.11 L 353.61 55.45 L 349.29 55.45 L 349.29 52.11 L 347.97 51.76 C 346.95 51.49 346.18 51.07 345.21 50.5 L 344.03 49.8 L 341.68 52.17 L 339.07 49.53 L 340.46 48.13 L 341.33 47.02 L 340.65 45.85 C 340.1 44.89 339.73 44.25 339.48 43.3 L 339.13 41.98 L 335.81 41.98 Z M 351.45 48.89 C 356.45 48.89 360.52 44.82 360.52 39.82 C 360.52 34.82 356.45 30.75 351.45 30.75 C 346.45 30.75 342.38 34.82 342.38 39.82 C 342.38 44.82 346.45 48.89 351.45 48.89 Z M 351.45 34.29 C 354.5 34.29 356.98 36.77 356.98 39.82 C 356.98 42.87 354.5 45.35 351.45 45.35 C 348.4 45.35 345.92 42.87 345.92 39.82 C 345.92 36.77 348.4 34.29 351.45 34.29 Z" fill="#ff0000" stroke="none" pointer-events="all"/><ellipse cx="367.38" cy="377.5" rx="33.62" ry="33" fill="rgb(255, 255, 255)" stroke="#ff0000" stroke-width="3" pointer-events="all"/><path d="M 340.48 397.3 C 342.32 392.86 350.08 389.59 359.31 389.38 C 359.9 389.48 360.51 389.31 360.96 388.93 C 361.41 388.55 361.67 387.99 361.66 387.4 C 362.13 383.19 360.5 379.01 357.29 376.18 C 356.48 376.18 355.81 374.55 355.81 372.55 C 355.81 370.55 356.48 368.92 357.29 368.92 C 356.92 366.01 357.79 363.08 359.7 360.82 C 361.61 358.57 364.4 357.2 367.38 357.04 C 370.36 357.2 373.15 358.57 375.06 360.82 C 376.97 363.08 377.84 366.01 377.47 368.92 C 378.28 368.92 378.95 370.55 378.95 372.55 C 378.95 374.55 378.28 376.18 377.47 376.18 C 374.26 379.01 372.63 383.19 373.1 387.4 C 373.09 387.99 373.35 388.55 373.8 388.93 C 374.25 389.31 374.86 389.48 375.45 389.38 C 384.68 389.59 392.44 392.86 394.28 397.3" fill="none" stroke="#ff0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="10" y="53" width="209" height="99" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 201px; height: 1px; padding-top: 43px; margin-left: 15px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 109px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1><span style="background-color: initial;"><font color="#ff0000">PBA\M</font></span></h1><div><span style="background-color: initial;"><font color="#000000">The Policy-Based Access Model defines the account-scoped <b style="">policy</b> object and its comprising parts.</font></span></div></div></div></div></foreignObject><text x="15" y="54" fill="#FFFFFF" font-family="Helvetica" font-size="11px">PBA\M...</text></switch></g><rect x="428" y="152" width="220" height="110" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 212px; height: 1px; padding-top: 142px; margin-left: 433px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 120px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1 style="font-size: 16px;"><span style="background-color: initial;"><font color="#ff0000" style="font-size: 16px;">Policy Principle Requirements</font></span></h1><h1 style="font-size: 12px;"><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;">The policy's </span><span style="background-color: initial;"><font color="#ff0000">principle requirements</font></span><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;"> are a set of conditions that a principle</span><span style="color: rgb(0, 0, 0); background-color: initial;"> <span style="font-weight: normal;">(i.e., user) must meet when assuming the policy.</span></span><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;"> </span></h1></div></div></div></foreignObject><text x="433" y="153" fill="#FFFFFF" font-family="Helvetica" font-size="11px">Policy Principle Requirements...</text></switch></g><rect x="434.98" y="20" width="220" height="99" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 212px; height: 1px; padding-top: 10px; margin-left: 440px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 109px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1 style="font-size: 16px;"><span style="background-color: initial;"><font color="#ff0000" style="font-size: 16px;">Policy Statements</font></span></h1><h1 style="font-size: 12px;"><span style="background-color: initial;"><span style="color: rgb(0, 0, 0); font-weight: normal;">The policy's </span><font color="#ff0000">statements</font><span style="color: rgb(0, 0, 0); font-weight: normal;"> are a set of </span><font color="#3333ff" style="font-weight: normal;">resource-based</font><font color="#000000" style="font-weight: normal;"> access assignments that will be granted </font></span><span style="color: rgb(0, 0, 0); background-color: initial;"><span style="font-weight: normal;">when assuming the policy.</span></span><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;"> </span></h1></div></div></div></foreignObject><text x="440" y="21" fill="#FFFFFF" font-family="Helvetica" font-size="11px">Policy Statements...</text></switch></g><rect x="428" y="328" width="220" height="99" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 212px; height: 1px; padding-top: 318px; margin-left: 433px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 109px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1 style="font-size: 16px;"><span style="background-color: initial;"><font color="#ff0000" style="font-size: 16px;">Policy Principles</font></span></h1><h1 style="font-size: 12px;"><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;">The policy's </span><span style="background-color: initial;"><font color="#ff0000">principles</font></span><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;"> are the set of entities (not object properties) that  each dictate some user in an account can assume the policy</span><span style="color: rgb(0, 0, 0); background-color: initial; font-weight: normal;"> </span></h1></div></div></div></foreignObject><text x="433" y="329" fill="#FFFFFF" font-family="Helvetica" font-size="11px">Policy Principles...</text></switch></g><path d="M 197 199.5 L 227 199.5 L 288 200 L 318 200" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 201 195.5 L 201 203.5 M 205 195.5 L 205 203.5" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><path d="M 314 204 L 314 196 M 310 204 L 310 196" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><path d="M 183 174 L 213 174 L 288 53 L 318 53" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 187 170 L 187 178 M 191 170 L 191 178" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><path d="M 314 57 L 314 49 M 310 57 L 310 49" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="all"/><path d="M 361.47 328 L 361.47 262" fill="none" stroke="#ff0000" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>m-Page-2.svg…]()


(III) Centralized Enforcement Point Model **(CEP\M)**

The CEP\M **is the ACM infrastructure concerned with evaluating access at a central point i.e., a gateway. It models the *authentication* of a request’s credential token, and the *authorization* of its policy - removing that responsibility from individual service APIs.  

- The credential token is an opaque token that is used to store the userId and account membership. It’s secret is the first part of a request’s authorization-header used to identify the user e.g., `"token 1ae2f755xuw-q2-1px/Auditor"`

The CEP **model **is the matrix point; granting or denying a request by (a) validating the request’s credential token; (b) validating the credential has principle rights to assume the policy;  (c) validating the credential meets the policy’s **principle requirements; and (d) comparing the policy’s granted resources to the resource required by the request’s best-matched service statement. In this model the policy’s data filters, if present, are passed down to the service. 

- (III.1) *Resource Authorizations* (is *p* allowed *s:r*) **are decoupled from service API layer.
- (III.1) *Resource Authorizations* (is *p* allowed *s:r*) **are evaluated independent of any context information about what service or resource attribute it’s being evaluated for.
- (III.2) *Resource Authorizations* (is *p* allowed *s:r*) are decoupled from the principle/credential context.
- (III.3) *Resource Authorizations* (is *p* allowed *s:r*) **are applied at a central gateway point.
- (III.4) *Resource Authorizations* (is *p* allowed *s:r*) are evaluated in a pure functional and standardized way.
- (III.5) *Resource Authorization* (is *p* allowed *s:r*) are adherent to the *Failsafe Default* principle.

![Uploading acm-<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="989px" height="386px" viewBox="-0.5 -0.5 989 386" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="549" y="31" width="99" height="343" fill="#ff8000" stroke="#ff8000" stroke-width="3" pointer-events="all"/><rect x="505" y="165" width="143" height="121" fill="rgb(255, 255, 255)" stroke="#ff8000" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/><rect x="109" y="109" width="154" height="89" fill="none" stroke="#ff8000" stroke-width="2" pointer-events="all"/><rect x="153" y="88" width="198" height="44" fill="#ff8000" stroke="#ffffff" pointer-events="all"/><rect x="98" y="92.12" width="242" height="16.88" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 240px; height: 1px; padding-top: 101px; margin-left: 100px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#ff8000"><b>GET</b>/compliance/evidence?type=aws HTTP/1.1</font></div></div></div></foreignObject><text x="100" y="104" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="10px">GET/compliance/evidence?type=aws HTTP/1.1</text></switch></g><rect x="98" y="109" width="242" height="16.88" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 240px; height: 1px; padding-top: 117px; margin-left: 100px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#ff8000"><b>Authorization: </b>"token xxxxx/policy-NID"</font></div></div></div></foreignObject><text x="100" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="10px">Authorization: "token xxxxx/policy-NID"</text></switch></g><rect x="519" y="187" width="52" height="44.66" fill="none" stroke="none" pointer-events="all"/><path d="M 550.36 218.6 C 550.36 219.4 551.01 220.05 551.81 220.05 C 552.6 220.05 553.25 219.4 553.25 218.6 C 553.25 217.81 552.6 217.16 551.81 217.16 C 551.01 217.16 550.36 217.81 550.36 218.6 Z M 565.56 218.24 L 564.77 218.24 C 564.49 218.24 564.22 218.14 564 217.95 L 563.52 217.54 L 563.04 217.95 C 562.83 218.14 562.55 218.24 562.27 218.24 L 561.43 218.24 C 561.15 218.24 560.88 218.14 560.67 217.95 L 560.19 217.54 L 559.7 217.95 C 559.49 218.14 559.22 218.24 558.93 218.24 L 557.45 218.24 C 556.95 218.24 556.51 217.92 556.34 217.45 C 555.86 216.09 554.44 215.14 552.89 215.14 C 550.9 215.14 549.27 216.7 549.27 218.6 C 549.27 220.51 550.9 222.07 552.89 222.07 C 554.44 222.07 555.86 221.12 556.34 219.76 C 556.51 219.29 556.95 218.97 557.45 218.97 L 565.87 218.97 L 566.08 218.72 Z M 567.36 220.89 C 567.13 221.17 566.79 221.33 566.44 221.33 L 558.21 221.33 C 557.2 223.19 555.12 224.43 552.89 224.43 C 549.59 224.43 546.91 221.81 546.91 218.6 C 546.91 215.4 549.59 212.78 552.89 212.78 C 555.12 212.78 557.2 214.02 558.21 215.88 L 558.5 215.88 L 559.41 215.09 C 559.86 214.71 560.51 214.71 560.95 215.09 L 561.85 215.86 L 562.75 215.09 C 563.19 214.71 563.85 214.71 564.29 215.09 L 565.21 215.88 L 566.02 215.88 C 566.32 215.88 566.61 215.99 566.82 216.19 L 568.49 217.74 C 568.52 217.77 568.53 217.8 568.56 217.83 C 568.41 211.78 563.46 206.91 557.38 206.91 C 551.2 206.91 546.18 211.93 546.18 218.1 C 546.18 224.28 551.2 229.3 557.38 229.3 C 563.07 229.3 567.78 225.02 568.47 219.51 Z M 557.38 231.66 C 549.9 231.66 543.82 225.58 543.82 218.1 C 543.82 210.63 549.9 204.55 557.38 204.55 C 564.85 204.55 570.93 210.63 570.93 218.1 C 570.93 225.58 564.85 231.66 557.38 231.66 Z M 526.96 223.03 C 527.18 223.26 527.49 223.39 527.81 223.39 C 528.13 223.39 528.44 223.26 528.67 223.03 L 535.54 215.81 L 533.83 214.18 L 527.81 220.5 L 525.23 217.79 L 523.52 219.42 Z M 526.24 211.7 L 529.01 208.93 L 531.79 211.7 L 533.46 210.04 L 530.68 207.26 L 533.46 204.49 L 531.79 202.82 L 529.01 205.59 L 526.24 202.82 L 524.57 204.49 L 527.34 207.26 L 524.57 210.04 Z M 526.24 200.36 L 529.01 197.58 L 531.79 200.36 L 533.46 198.69 L 530.68 195.92 L 533.46 193.14 L 531.79 191.47 L 529.01 194.25 L 526.24 191.47 L 524.57 193.14 L 527.34 195.92 L 524.57 198.69 Z M 543.69 224.13 L 543.69 226.49 L 521.61 226.49 C 520.21 226.49 519.07 225.35 519.07 223.95 L 519.07 189.54 C 519.07 188.14 520.21 187 521.61 187 L 546.73 187 C 548.13 187 549.27 188.14 549.27 189.54 L 549.27 205.72 L 546.91 205.72 L 546.91 189.54 C 546.91 189.44 546.83 189.36 546.73 189.36 L 521.61 189.36 C 521.51 189.36 521.43 189.44 521.43 189.54 L 521.43 223.95 C 521.43 224.05 521.51 224.13 521.61 224.13 Z" fill="#ff8000" stroke="none" pointer-events="all"/><rect x="191.5" y="143" width="55" height="44" fill="none" stroke="none" pointer-events="all"/><path d="M 213.58 171.13 L 213.58 171.74 L 224.46 171.74 L 224.46 171.13 Z M 213.58 167.43 L 213.58 168.04 L 214.81 168.04 C 213.68 168.7 212.44 169.85 211.84 170.91 C 211.71 170.52 211.59 170.33 211.39 170.1 C 211.22 169.93 210.92 169.93 210.82 169.99 C 210.6 170.13 210.47 170.25 210.4 170.36 C 211.04 170.67 211.23 171.44 211.5 172.11 C 211.64 171.92 212.04 171.62 212.32 171.58 C 212.73 170.56 214.33 168.74 215.39 168.04 L 224.46 168.04 L 224.46 167.43 Z M 213.58 163.73 L 213.58 164.35 L 214.79 164.35 C 213.66 165.01 212.44 166.15 211.84 167.2 C 211.71 166.81 211.59 166.62 211.39 166.39 C 211.22 166.22 210.92 166.22 210.82 166.28 C 210.6 166.42 210.47 166.54 210.4 166.65 C 211.04 166.96 211.23 167.72 211.5 168.4 C 211.64 168.2 212.04 167.91 212.32 167.87 C 212.73 166.86 214.31 165.05 215.38 164.35 L 224.46 164.35 L 224.46 163.73 Z M 215.34 160.35 C 214.07 160.91 212.54 162.26 211.84 163.49 C 211.71 163.1 211.59 162.9 211.39 162.67 C 211.22 162.51 210.92 162.51 210.82 162.57 C 210.6 162.71 210.47 162.82 210.4 162.94 C 211.04 163.25 211.23 164.01 211.5 164.69 C 211.64 164.49 212.04 164.21 212.32 164.16 C 212.75 163.1 214.47 161.15 215.53 160.53 C 215.5 160.45 215.41 160.38 215.34 160.35 Z M 209.19 153.37 C 208.29 153.37 207.53 154.07 207.53 154.91 L 207.53 177.06 C 207.53 177.9 208.29 178.61 209.19 178.61 L 228.81 178.61 C 229.71 178.61 230.47 177.9 230.47 177.06 L 230.47 154.91 C 230.47 154.07 229.71 153.37 228.81 153.37 L 223.92 153.37 L 223.92 154.2 C 223.92 154.86 224.34 155.21 225.4 155.21 L 227.61 155.21 C 228.22 155.21 228.48 155.58 228.48 156.08 L 228.48 175.76 C 228.48 176.45 228.06 176.76 227.4 176.76 L 210.53 176.76 C 209.85 176.76 209.52 176.47 209.52 175.71 L 209.52 156.1 C 209.52 155.46 209.84 155.21 210.46 155.21 L 212.92 155.21 C 213.56 155.21 214.07 154.8 214.07 154.24 L 214.07 153.37 Z M 218.83 153.33 C 219.35 153.33 219.78 153.73 219.78 154.21 C 219.78 154.7 219.35 155.09 218.83 155.09 C 218.31 155.09 217.88 154.7 217.88 154.21 C 217.88 153.73 218.31 153.33 218.83 153.33 Z M 218.92 151.4 C 217.09 151.4 215.87 152.72 215.87 154.33 L 215.87 155.52 C 215.87 156.18 215.36 156.48 214.59 156.68 C 213.23 156.99 212.64 157.87 212.6 159.15 L 225.28 159.17 C 225.17 157.93 224.69 157.01 223.08 156.62 C 222.43 156.45 221.96 156.01 221.96 155.5 L 221.97 154.2 C 221.97 152.95 220.94 151.4 218.92 151.4 Z M 205.11 187 L 191.5 164.91 L 205.06 143 L 232.9 143 L 246.5 164.91 L 232.9 187 Z" fill="#ff8000" stroke="none" pointer-events="all"/><rect x="192.05" y="143.44" width="53.9" height="43.12" fill="none" stroke="none" pointer-events="all"/><path d="M 205.38 186.56 L 192.05 164.92 L 205.34 143.44 L 232.63 143.44 L 245.95 164.92 L 232.62 186.56 Z" fill="#ffffff" stroke="none" pointer-events="all"/><rect x="191.5" y="143" width="55" height="44" fill="none" stroke="none" pointer-events="all"/><path d="M 213.58 171.13 L 213.58 171.74 L 224.46 171.74 L 224.46 171.13 Z M 213.58 167.43 L 213.58 168.04 L 214.81 168.04 C 213.68 168.7 212.44 169.85 211.84 170.91 C 211.71 170.52 211.59 170.33 211.39 170.1 C 211.22 169.93 210.92 169.93 210.82 169.99 C 210.6 170.13 210.47 170.25 210.4 170.36 C 211.04 170.67 211.23 171.44 211.5 172.11 C 211.64 171.92 212.04 171.62 212.32 171.58 C 212.73 170.56 214.33 168.74 215.39 168.04 L 224.46 168.04 L 224.46 167.43 Z M 213.58 163.73 L 213.58 164.35 L 214.79 164.35 C 213.66 165.01 212.44 166.15 211.84 167.2 C 211.71 166.81 211.59 166.62 211.39 166.39 C 211.22 166.22 210.92 166.22 210.82 166.28 C 210.6 166.42 210.47 166.54 210.4 166.65 C 211.04 166.96 211.23 167.72 211.5 168.4 C 211.64 168.2 212.04 167.91 212.32 167.87 C 212.73 166.86 214.31 165.05 215.38 164.35 L 224.46 164.35 L 224.46 163.73 Z M 215.34 160.35 C 214.07 160.91 212.54 162.26 211.84 163.49 C 211.71 163.1 211.59 162.9 211.39 162.67 C 211.22 162.51 210.92 162.51 210.82 162.57 C 210.6 162.71 210.47 162.82 210.4 162.94 C 211.04 163.25 211.23 164.01 211.5 164.69 C 211.64 164.49 212.04 164.21 212.32 164.16 C 212.75 163.1 214.47 161.15 215.53 160.53 C 215.5 160.45 215.41 160.38 215.34 160.35 Z M 209.19 153.37 C 208.29 153.37 207.53 154.07 207.53 154.91 L 207.53 177.06 C 207.53 177.9 208.29 178.61 209.19 178.61 L 228.81 178.61 C 229.71 178.61 230.47 177.9 230.47 177.06 L 230.47 154.91 C 230.47 154.07 229.71 153.37 228.81 153.37 L 223.92 153.37 L 223.92 154.2 C 223.92 154.86 224.34 155.21 225.4 155.21 L 227.61 155.21 C 228.22 155.21 228.48 155.58 228.48 156.08 L 228.48 175.76 C 228.48 176.45 228.06 176.76 227.4 176.76 L 210.53 176.76 C 209.85 176.76 209.52 176.47 209.52 175.71 L 209.52 156.1 C 209.52 155.46 209.84 155.21 210.46 155.21 L 212.92 155.21 C 213.56 155.21 214.07 154.8 214.07 154.24 L 214.07 153.37 Z M 218.83 153.33 C 219.35 153.33 219.78 153.73 219.78 154.21 C 219.78 154.7 219.35 155.09 218.83 155.09 C 218.31 155.09 217.88 154.7 217.88 154.21 C 217.88 153.73 218.31 153.33 218.83 153.33 Z M 218.92 151.4 C 217.09 151.4 215.87 152.72 215.87 154.33 L 215.87 155.52 C 215.87 156.18 215.36 156.48 214.59 156.68 C 213.23 156.99 212.64 157.87 212.6 159.15 L 225.28 159.17 C 225.17 157.93 224.69 157.01 223.08 156.62 C 222.43 156.45 221.96 156.01 221.96 155.5 L 221.97 154.2 C 221.97 152.95 220.94 151.4 218.92 151.4 Z M 205.11 187 L 191.5 164.91 L 205.06 143 L 232.9 143 L 246.5 164.91 L 232.9 187 Z" fill="#ff8000" stroke="none" pointer-events="all"/><rect x="571" y="209" width="66" height="66" fill="none" stroke="none" pointer-events="all"/><path d="M 602.5 209 L 602.5 212 L 634 212 L 634 230 L 607 230 L 607 233 L 634 233 L 634 251 L 574 251 L 574 240.5 L 571 240.5 L 571 251 L 571 252.5 L 571 275 L 637 275 L 637 252.5 L 637 251 L 637 231.5 L 637 230 L 637 209 Z M 574 272 L 574 254 L 634 254 L 634 272 Z M 629.6 218.42 L 621.6 226.43 L 615.67 222.22 L 617.41 219.78 L 621.27 222.51 L 627.48 216.3 Z M 629.6 239.42 L 621.6 247.43 L 615.67 243.22 L 617.41 240.78 L 621.27 243.51 L 627.48 237.3 Z M 616.89 266.62 L 620.42 263.09 L 616.89 259.56 L 619.01 257.44 L 622.54 260.97 L 626.07 257.44 L 628.19 259.56 L 624.66 263.09 L 628.19 266.62 L 626.07 268.74 L 622.54 265.21 L 619.01 268.74 Z M 573.38 230.6 L 574.84 230.6 C 574.97 230.91 575.12 231.2 575.27 231.49 L 574.27 232.5 C 573.46 233.32 573.46 234.66 574.27 235.48 L 577.73 238.97 C 578.53 239.77 579.93 239.77 580.73 238.97 L 581.73 237.97 C 582.03 238.12 582.34 238.27 582.67 238.41 L 582.67 239.89 C 582.67 241.05 583.62 242 584.79 242 L 590.21 242 C 591.38 242 592.33 241.05 592.33 239.89 L 592.33 238.4 C 592.64 238.27 592.93 238.13 593.22 237.97 L 594.23 238.98 C 595.05 239.79 596.39 239.79 597.21 238.97 L 600.69 235.51 C 601.1 235.11 601.32 234.58 601.32 234.01 C 601.32 233.44 601.1 232.91 600.7 232.51 L 599.7 231.52 C 599.85 231.23 600 230.92 600.13 230.6 L 601.62 230.6 C 602.78 230.6 603.73 229.65 603.73 228.48 L 603.73 223.06 C 603.73 221.89 602.78 220.94 601.62 220.94 L 600 220.94 C 599.87 220.62 599.72 220.31 599.57 220.02 L 600.57 219.01 C 601.38 218.2 601.38 216.86 600.57 216.04 L 597.15 212.58 C 596.34 211.76 594.93 211.76 594.13 212.58 L 593.18 213.55 C 592.9 213.4 592.63 213.26 592.33 213.14 L 592.33 211.65 C 592.33 210.49 591.38 209.54 590.21 209.54 L 584.79 209.54 C 583.62 209.54 582.67 210.49 582.67 211.65 L 582.67 213.08 C 582.36 213.21 582.07 213.35 581.78 213.51 L 580.77 212.51 C 579.95 211.69 578.62 211.69 577.79 212.51 L 574.3 215.98 C 573.9 216.38 573.68 216.91 573.68 217.48 C 573.68 218.05 573.9 218.58 574.3 218.98 L 575.31 219.98 C 575.15 220.28 575 220.6 574.86 220.94 L 573.38 220.94 C 572.22 220.94 571.27 221.89 571.27 223.06 L 571.27 228.48 C 571.27 229.65 572.22 230.6 573.38 230.6 Z M 574.27 223.94 L 577.1 223.94 L 577.39 222.83 C 577.63 221.94 578 221.26 578.46 220.47 L 579.05 219.47 L 577.05 217.48 L 579.28 215.26 L 580.47 216.44 L 581.41 217.18 L 582.4 216.6 C 583.22 216.13 583.75 215.82 584.56 215.61 L 585.67 215.31 L 585.67 212.54 L 589.33 212.54 L 589.33 215.35 L 590.44 215.65 C 591.22 215.86 591.75 216.17 592.67 216.72 L 593.68 217.31 L 595.64 215.32 L 597.82 217.53 L 595.85 219.53 L 596.41 220.51 C 596.94 221.43 597.25 222 597.47 222.82 L 597.76 223.94 L 600.73 223.94 L 600.73 227.6 L 597.9 227.6 L 597.6 228.71 C 597.38 229.54 597.05 230.13 596.53 231.01 L 595.95 232.02 L 597.95 234.01 L 595.72 236.23 L 593.71 234.23 L 592.56 234.9 C 591.77 235.36 591.24 235.67 590.45 235.87 L 589.33 236.17 L 589.33 239 L 585.67 239 L 585.67 236.17 L 584.56 235.88 C 583.69 235.65 583.04 235.29 582.22 234.81 L 581.22 234.22 L 579.23 236.22 L 577.02 233.99 L 578.2 232.8 L 578.94 231.86 L 578.36 230.87 C 577.89 230.06 577.58 229.52 577.37 228.71 L 577.08 227.6 L 574.27 227.6 Z M 587.5 233.45 C 591.73 233.45 595.18 230 595.18 225.77 C 595.18 221.54 591.73 218.09 587.5 218.09 C 583.27 218.09 579.82 221.54 579.82 225.77 C 579.82 230 583.27 233.45 587.5 233.45 Z M 587.5 221.09 C 590.08 221.09 592.18 223.19 592.18 225.77 C 592.18 228.35 590.08 230.45 587.5 230.45 C 584.92 230.45 582.82 228.35 582.82 225.77 C 582.82 223.19 584.92 221.09 587.5 221.09 Z" fill="#ff8000" stroke="none" pointer-events="all"/><ellipse cx="565.5" cy="181.5" rx="27.500000000000004" ry="27.500000000000004" fill="rgb(255, 255, 255)" stroke="#ff8000" stroke-width="2" pointer-events="all"/><path d="M 543.5 198 C 545 194.3 551.35 191.58 558.9 191.4 C 559.38 191.48 559.88 191.34 560.25 191.03 C 560.62 190.71 560.83 190.24 560.83 189.75 C 561.2 186.24 559.87 182.76 557.25 180.4 C 556.58 180.4 556.04 179.05 556.04 177.38 C 556.04 175.7 556.58 174.35 557.25 174.35 C 556.94 171.93 557.65 169.48 559.22 167.6 C 560.78 165.73 563.06 164.58 565.5 164.45 C 567.94 164.58 570.22 165.73 571.78 167.6 C 573.35 169.48 574.06 171.93 573.75 174.35 C 574.42 174.35 574.96 175.7 574.96 177.38 C 574.96 179.05 574.42 180.4 573.75 180.4 C 571.13 182.76 569.8 186.24 570.17 189.75 C 570.17 190.24 570.38 190.71 570.75 191.03 C 571.12 191.34 571.62 191.48 572.1 191.4 C 579.65 191.58 586 194.3 587.5 198" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="131" y="143" width="55" height="44" fill="none" stroke="none" pointer-events="all"/><path d="M 131 149.22 L 137.42 143.04 L 172.7 143.04 C 174.8 143 176.58 144.5 176.83 146.5 L 176.83 148.28 L 174.28 147.42 C 174.33 146.43 173.56 145.59 172.54 145.5 L 138.77 145.5 L 138.77 150.59 L 133.56 150.59 L 133.56 168.98 C 133.62 169.69 134.18 170.27 134.91 170.39 L 153.45 170.39 L 154.92 172.8 L 134.7 172.8 C 132.74 172.53 131.23 171.02 131 169.13 Z M 156.01 183.44 L 160.79 175.58 C 155.17 171.87 152.77 165.03 154.89 158.79 C 157.01 152.55 163.15 148.4 169.96 148.62 C 176.77 148.84 182.62 153.36 184.31 159.72 C 186 166.08 183.13 172.76 177.27 176.1 L 182.65 183.91 L 176.78 182.39 L 175.09 186.95 L 168.79 178.83 L 164 187 L 161.83 182.08 Z M 156.06 163.53 C 156.41 170.45 162.3 175.92 169.49 176 C 176.63 175.84 182.42 170.4 182.76 163.53 C 182.56 156.64 176.86 151.07 169.71 150.8 C 162.33 150.76 156.27 156.42 156.06 163.53 Z M 159.33 163.53 C 159.31 160.93 160.38 158.43 162.29 156.6 C 164.2 154.77 166.8 153.75 169.49 153.78 C 172.16 153.8 174.71 154.83 176.59 156.66 C 178.47 158.49 179.51 160.96 179.5 163.53 C 179.38 168.78 174.94 172.98 169.49 173.01 C 163.98 173.07 159.45 168.84 159.33 163.53 Z M 161.56 163.53 C 161.78 167.62 165.24 170.86 169.49 170.97 C 173.71 170.81 177.1 167.59 177.32 163.53 C 177.21 159.39 173.79 156.04 169.49 155.88 C 165.16 155.99 161.67 159.35 161.56 163.53 Z" fill="#ff8000" stroke="none" pointer-events="all"/><rect x="505" y="91.57" width="143" height="62.43" fill="rgb(255, 255, 255)" stroke="#ff8000" stroke-width="2" stroke-dasharray="6 6" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 136px; height: 1px; padding-top: 123px; margin-left: 512px;"><div data-drawio-colors="color: #FF8000; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 10px;">required resource: <b>compliance:evidence</b></font></div></div></div></foreignObject><text x="512" y="126" fill="#FF8000" font-family="Helvetica" font-size="11px">required resource: compli...</text></switch></g><path d="M 450 108.05 L 491.76 108.01" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 497.76 108 L 489.77 112.01 L 491.76 108.01 L 489.76 104.01 Z" fill="#ff8000" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 106px; margin-left: 499px;"><div data-drawio-colors="color: #FF8000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Target</div></div></div></foreignObject><text x="499" y="106" fill="#FF8000" font-family="Helvetica" font-size="10px" text-anchor="end">Target</text></switch></g><path d="M 183.95 198 L 490.76 198" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 496.76 198 L 488.76 202 L 490.76 198 L 488.76 194 Z" fill="#ff8000" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 198px; margin-left: 384px;"><div data-drawio-colors="color: #FF8000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;"><b><font style="font-size: 11px;">IAM</font></b></div></div></div></foreignObject><text x="384" y="201" fill="#FF8000" font-family="Helvetica" font-size="10px" text-anchor="middle">IAM</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 196px; margin-left: 188px;"><div data-drawio-colors="color: #FF8000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">request authorization header</div></div></div></foreignObject><text x="188" y="196" fill="#FF8000" font-family="Helvetica" font-size="10px">request authorization header</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 196px; margin-left: 498px;"><div data-drawio-colors="color: #FF8000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Target</div></div></div></foreignObject><text x="498" y="196" fill="#FF8000" font-family="Helvetica" font-size="10px" text-anchor="end">Target</text></switch></g><rect x="417" y="91.57" width="33" height="33" fill="none" stroke="none" pointer-events="all"/><path d="M 420.81 115.51 C 420.35 114.72 419.96 113.88 419.66 113.02 L 421.07 112.53 C 421.34 113.3 421.69 114.04 422.1 114.75 Z M 420.84 104.77 L 419.39 104.37 C 419.71 103.23 420.18 102.13 420.77 101.11 L 422.07 101.86 C 421.54 102.77 421.12 103.76 420.84 104.77 Z M 427.94 96.56 L 427.33 95.19 C 431.02 93.53 435.36 93.53 439.06 95.19 L 438.44 96.56 C 435.1 95.07 431.28 95.07 427.94 96.56 Z M 444.31 101.86 L 445.61 101.11 C 446.2 102.13 446.67 103.23 446.99 104.37 L 445.55 104.77 C 445.26 103.75 444.84 102.77 444.31 101.86 Z M 445.31 112.53 L 446.72 113.02 C 446.43 113.86 446.06 114.67 445.61 115.44 L 444.31 114.69 C 444.71 114 445.05 113.27 445.31 112.53 Z M 438.44 119.99 L 439.06 121.36 C 437.21 122.19 435.23 122.61 433.19 122.61 C 431.15 122.61 429.17 122.19 427.33 121.36 L 427.94 119.99 C 431.25 121.48 435.13 121.48 438.44 119.99 Z M 424.13 120.27 C 423.09 120.27 422.25 119.43 422.25 118.4 C 422.25 117.37 423.09 116.52 424.13 116.52 C 425.16 116.52 426 117.37 426 118.4 C 426 119.43 425.16 120.27 424.13 120.27 Z M 424.13 115.02 C 422.26 115.02 420.75 116.54 420.75 118.4 C 420.75 120.26 422.26 121.77 424.13 121.77 C 425.99 121.77 427.5 120.26 427.5 118.4 C 427.5 116.54 425.99 115.02 424.13 115.02 Z M 442.13 120.27 C 441.09 120.27 440.25 119.43 440.25 118.4 C 440.25 117.37 441.09 116.52 442.13 116.52 C 443.16 116.52 444 117.37 444 118.4 C 444 119.43 443.16 120.27 442.13 120.27 Z M 442.13 115.02 C 440.26 115.02 438.75 116.54 438.75 118.4 C 438.75 120.26 440.26 121.77 442.13 121.77 C 443.99 121.77 445.5 120.26 445.5 118.4 C 445.5 116.54 443.99 115.02 442.13 115.02 Z M 418.5 108.65 C 418.5 107.62 419.34 106.77 420.38 106.77 C 421.41 106.77 422.25 107.62 422.25 108.65 C 422.25 109.68 421.41 110.52 420.38 110.52 C 419.34 110.52 418.5 109.68 418.5 108.65 Z M 423.71 109.02 L 426.1 109.02 L 425.38 110.11 L 426.62 110.94 L 428.12 108.7 C 428.29 108.45 428.29 108.12 428.12 107.87 L 426.62 105.61 L 425.38 106.44 L 426.1 107.52 L 423.54 107.52 C 423.08 106.22 421.84 105.27 420.38 105.27 C 418.51 105.27 417 106.79 417 108.65 C 417 110.51 418.51 112.02 420.38 112.02 C 422.11 112.02 423.52 110.71 423.71 109.02 Z M 446.63 110.52 C 445.59 110.52 444.75 109.68 444.75 108.65 C 444.75 107.62 445.59 106.77 446.63 106.77 C 447.66 106.77 448.5 107.62 448.5 108.65 C 448.5 109.68 447.66 110.52 446.63 110.52 Z M 446.63 105.27 C 444.76 105.27 443.25 106.79 443.25 108.65 C 443.25 110.51 444.76 112.02 446.63 112.02 C 448.49 112.02 450 110.51 450 108.65 C 450 106.79 448.49 105.27 446.63 105.27 Z M 424.13 96.27 C 425.16 96.27 426 97.12 426 98.15 C 426 99.18 425.16 100.02 424.13 100.02 C 423.09 100.02 422.25 99.18 422.25 98.15 C 422.25 97.12 423.09 96.27 424.13 96.27 Z M 424.13 101.52 C 425.99 101.52 427.5 100.01 427.5 98.15 C 427.5 96.29 425.99 94.77 424.13 94.77 C 422.26 94.77 420.75 96.29 420.75 98.15 C 420.75 100.01 422.26 101.52 424.13 101.52 Z M 442.13 96.27 C 443.16 96.27 444 97.12 444 98.15 C 444 99.18 443.16 100.02 442.13 100.02 C 441.09 100.02 440.25 99.18 440.25 98.15 C 440.25 97.12 441.09 96.27 442.13 96.27 Z M 442.13 101.52 C 443.99 101.52 445.5 100.01 445.5 98.15 C 445.5 96.29 443.99 94.77 442.13 94.77 C 440.26 94.77 438.75 96.29 438.75 98.15 C 438.75 100.01 440.26 101.52 442.13 101.52 Z M 439.63 110.11 L 440.35 109.03 L 438.75 109.03 L 438.75 107.53 L 440.35 107.53 L 439.63 106.44 L 440.87 105.61 L 442.37 107.86 C 442.54 108.11 442.54 108.44 442.37 108.69 L 440.87 110.94 Z M 436.64 111.43 C 435.63 111.1 434.57 110.93 433.5 110.93 C 432.42 110.93 431.34 111.1 430.36 111.43 C 430.69 110.47 430.86 109.4 430.86 108.27 C 430.86 107.15 430.69 106.08 430.36 105.12 C 432.32 105.78 434.68 105.78 436.64 105.12 C 436.32 106.08 436.14 107.15 436.14 108.27 C 436.14 109.4 436.32 110.47 436.64 111.43 Z M 439.29 103.55 C 439.43 103.4 439.51 103.21 439.51 103.02 C 439.51 102.83 439.43 102.64 439.29 102.49 C 438.99 102.2 438.52 102.2 438.23 102.49 C 436.02 104.7 430.98 104.7 428.78 102.49 C 428.48 102.2 428.01 102.2 427.72 102.49 C 427.57 102.64 427.5 102.83 427.5 103.02 C 427.5 103.21 427.57 103.4 427.72 103.55 C 428.75 104.58 429.36 106.35 429.36 108.27 C 429.36 110.2 428.75 111.97 427.72 113 C 427.58 113.14 427.5 113.33 427.5 113.53 C 427.5 113.72 427.57 113.91 427.72 114.06 C 428.01 114.35 428.48 114.35 428.78 114.06 C 430.98 111.85 436.02 111.85 438.23 114.06 C 438.37 114.21 438.56 114.28 438.76 114.28 C 438.95 114.28 439.14 114.21 439.29 114.06 C 439.43 113.91 439.51 113.72 439.51 113.53 C 439.51 113.33 439.43 113.14 439.29 113 C 438.26 111.97 437.64 110.2 437.64 108.27 C 437.64 106.35 438.26 104.58 439.29 103.55 Z" fill="#ff8000" stroke="none" pointer-events="all"/><path d="M 340 108 L 417 108.06" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 106px; margin-left: 337px;"><div data-drawio-colors="color: #FF8000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">request path</div></div></div></foreignObject><text x="337" y="106" fill="#FF8000" font-family="Helvetica" font-size="10px">request path</text></switch></g><path d="M 626 333 L 738.03 333" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 726.26 340 L 740.26 333 L 726.26 326" fill="none" stroke="#ff8000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 330px; margin-left: 677px;"><div data-drawio-colors="color: #FF8000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(255, 128, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: nowrap;">GRANT</div></div></div></foreignObject><text x="677" y="330" fill="#FF8000" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">GRANT</text></switch></g><rect x="659" y="332" width="220" height="16.88" fill="rgb(255, 255, 255)" stroke="#ff8000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 218px; height: 1px; padding-top: 340px; margin-left: 661px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#ff8000"><b>GET</b>/compliance/evidence?type=aws HTTP/1.1</font></div></div></div></foreignObject><text x="661" y="343" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="10px">GET/compliance/evidence?type=aws HTTP/1.1</text></switch></g><rect x="615" y="11" width="67.23" height="69" fill="none" stroke="none" pointer-events="all"/><path d="M 615 46.28 L 626.09 57.36 L 628.3 55.15 L 620.22 47.06 L 646.79 47.06 L 646.79 75.37 L 620.92 60.43 L 619.36 63.15 L 648.36 79.89 L 677.36 63.15 L 675.79 60.43 L 649.93 75.37 L 649.93 47.06 L 676.14 47.06 L 668.93 54.27 L 671.15 56.49 L 682.23 45.41 L 671.15 34.32 L 668.93 36.54 L 676.32 43.93 L 649.93 43.93 L 649.93 15.63 L 675.79 30.57 L 677.36 27.85 L 648.36 11.11 L 619.36 27.85 L 620.92 30.57 L 646.79 15.63 L 646.79 43.93 L 621.78 43.93 L 628.3 37.41 L 626.09 35.2 Z" fill="#ff8000" stroke="none" pointer-events="all"/><rect x="610" y="17.12" width="67.23" height="69" fill="none" stroke="none" pointer-events="all"/><path d="M 610 52.4 L 621.09 63.48 L 623.3 61.27 L 615.22 53.18 L 641.79 53.18 L 641.79 81.49 L 615.92 66.55 L 614.36 69.27 L 643.36 86.01 L 672.36 69.27 L 670.79 66.55 L 644.93 81.49 L 644.93 53.18 L 671.14 53.18 L 663.93 60.39 L 666.15 62.61 L 677.23 51.53 L 666.15 40.44 L 663.93 42.66 L 671.32 50.05 L 644.93 50.05 L 644.93 21.75 L 670.79 36.69 L 672.36 33.97 L 643.36 17.23 L 614.36 33.97 L 615.92 36.69 L 641.79 21.75 L 641.79 50.05 L 616.78 50.05 L 623.3 43.53 L 621.09 41.32 Z" fill="#ffffff" stroke="none" pointer-events="all"/><rect x="10" y="165" width="264" height="121" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 256px; height: 1px; padding-top: 155px; margin-left: 15px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 131px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1><span style="background-color: initial;"><font color="#ff8000">CEP\M</font></span></h1><div><span style="background-color: initial;"><font color="#000000">The central enforcement point is an authorization and authentication gateway. The credential and policy are validated and the requested resource is granted or denied.</font></span></div></div></div></div></foreignObject><text x="15" y="166" fill="#FFFFFF" font-family="Helvetica" font-size="11px">CEP\M...</text></switch></g><rect x="659" y="104.5" width="264" height="121" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 256px; height: 1px; padding-top: 95px; margin-left: 664px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 131px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1 style="font-size: 18px;"><span style="background-color: initial;"><font color="#ff8000" style="font-size: 18px;">Required Resource</font></span></h1><div style=""><span style="background-color: initial;"><font style="font-size: 11px;"><font color="#000000">The required resource is fetched via the RAD broker. The broker finds the best-matched </font><i style=""><font color="#0038a8">service statement</font></i><font color="#000000"> based on the requested path; that statement identifies the required resource.</font></font></span></div></div></div></div></foreignObject><text x="664" y="106" fill="#FFFFFF" font-family="Helvetica" font-size="11px">Required Resource...</text></switch></g><rect x="659" y="209" width="319" height="99" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 311px; height: 1px; padding-top: 199px; margin-left: 664px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 109px; overflow: hidden;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1 style="font-size: 18px;"><span style="background-color: initial;"><font color="#ff8000" style="font-size: 18px;">Grant or Deny</font></span></h1><span style="color: rgb(0, 0, 0);">(a) validate the credential token; (b) validate the </span><font color="#000000">credential has principle rights to assume the policy;  (c) validate the credential meets the policy’s<span style="font-style:italic" data-token-index="1" class="notion-enable-hover" data-reactroot=""> </span>principle requirements; and (d) check if the policy grants the required resource. </font></div></div></div></foreignObject><text x="664" y="210" fill="#FFFFFF" font-family="Helvetica" font-size="11px">Grant or Deny(a) validate the credential token; (b) valid...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>Page-3.svg…]()


## Sudo Access Control Model Flow

This is a sudo sample of the ACM to illustrate the three models’ (RAD\M, PBA\M, CEP\M) role, responsibilities, and interaction points that link them.

(1) Assume that our mock Platform has compiled the following centralized resources and service statements from all our services (RAD\M)

```json
//resource universe
"compliance:controlsMapping"
"compliance:evidence"
"compliance:evidence:external"
"compliance:framework"
"compliance:libraryItem"
"compliance:requirement"
"compliance:standard"
"dashboard"
"iam:account"
"iam:api-key"
"iam:client"
"iam:group"
"iam:group:membership"
"iam:invitation"
"iam:token"
"iam:user"
"iam:user:account"
"iam:user:identity"
"integration:instance"
"integration:sync-job"
"parameter"
"query:edge"
"query:entity"
"query:rawData"
"query:rawData:version"
"query:relationship"
"query:vertex"
"question"
"rule:instance"
"rule:invocation"
"settings:accountSettings"

//service statements
"compliance:compliance/evidence/*":"compliance:evidence"
"compliance:mutation/createControlMapping":"compliance:controlsMapping"
"compliance:mutation/uploadExternalEvidence":"compliance:externalEvidence"
"compliance:query/framework":"compliance:framework"
"compliance:query/noteEvidence":"compliance:evidence"
"compliance:query/requirementNote":"compliance:requirement"
"compliance:query/requirementNoteUserEvidence":"compliance:requirement"
"compliance:query/userEvidenceWithUpload":"compliance:evidence"
"dashboard:dashboard/*":"dashboard"
"dashboard:query/getDashboard":"dashboard"
"iam:account/group/membership/*":"iam:group:membership"
"iam:account/groups/*":"iam:group"
"iam:account/users/*":"iam:user"
"iam:mutation/createToken":"iam:token"
"iam:mutation/inviteUser":"iam:invitation"
"iam:query/getUser":"iam:user"
"iam:query/getUserAccounts":"iam:user:account"
"iam:query/getUserProvider":"iam:user:identity"
"iam:query/invitations":"iam:invitation"
"iam:query/resolveToken":"iam:token"
"integration:integrations/sync/*":"integration:sync"
"integration:mutation/createIntegration":"integration:instance"
"integration:mutation/updateIntegration":"integration:instance"
"integration:query/myIntegrations":"integration:instance"
"parameter:paramters/*":"parameter"
"query:graph/vertexNeighbors":"query:vertex"
"query:mutation/createEntity":"query:entity"
"query:mutation/createRelationship":"query:relationship"
"query:mutation/deleteEntity":"query:entity"
"query:mutation/updateEntity":"query:entity"
"query:mutation/updateRelationship":"query:relationship"
"query:mutation/upsertEntityRawData":"query:rawData"
"query:query/edge":"query:edge"
"query:query/entityCount": "query:entity"
"query:query/entityRawData":"query:rawData"
"query:query/entityRawDataVersions":"query:rawData:version"
"query:query/relationship":"query:relationship"
"query:query/typeCount":"query:entity"
"rule:mutation/createRule":"rule:instance"
"rule:query/myRules":"rule:instance"
"rule:rules/createRule":"rule:instance"
"rule:rules/evaluate":"rule:invocation"
"settings:settings/*":"settings:accountSettings"
```

(2) Assume some customer account, x*Dev,* defines an Authorization Policy: *AWS-Auditor* (PBA\M).

- x*Dev* chose to assign someone with userId: *`000-000-000`* the right to assume this policy.
- x*Dev* wants to limit this user’s right to assume the policy only when their location is identified by the ip:address: `10:00.01`
- *xDev* wants this policy to have only auditor-related access to resources and to filter the data to specific AWS stuff in some cases. It also needs full token access.

```jsx

{
	accountId: 'xDev',
	authorizationPolicyId: '934-x23-543',
	authorizationPolicyNameId: `AWS-Auditor`,
	authorizationPolicyPrincipleRequirements: {
     ip_address: [10.00.01],
  },
	authorizationPolicyStatements: [
    "read":"query:*":[{"_tag":"aws"}],
	  "read":"compliance:evidence":["*"],
    "read":"compliance:standard:*":[{"type":"aws"}],
	  "read":"integration:instance:*":[{"id": ["aws_19300-22-876", "aws_19300-11-644"]}],
    "admin":"integration:sync:*":["*"],
    "admin":"question:*":["*"],
    "admin":"iam:token":["*"]
	]
}
```

```jsx
{
	accountId: 'xDev';	
	principleId: 'user:0000-0000-0000';
	credentialTokenId: '1ae2f755xuw-q2-1px';
	credentialTokenScope: 'session' | 'api'
	credentialTokenRevoked: false;
	__issued: 1666291438;
	__expires: 1766291438;
}
```

```jsx
{
	userId: '0000-0000-0000',
	accountId: 'xDev',
	authorizationPolicyId: 'AWS-Auditor'
}
```

(3) the user: *000-000-000* (assuming membership in the ****xDev**** account) can login to the ****xDev**** account to get issued a valid *session* `credentialToken` that is stored as a browser cookie. On future requests, this credentialToken is attached.

```markdown
		───WEB────────┬─────────────┐                                            
(1) apps.xxx.io│  USER   │                                            
    ──────────────────┼─────────┴──────────┐                                 
                      │AUTHENTICATED: FALSE│                                 
                      └────────────────────┴─────/LOGIN                      
                      └──http://iam/authenticate/account/xdev               
                                                                             
                      (+) Has valid account membership                       
                      (+) Has valid account login provider                   
                      (+) Has valid account policies assigned                
                      [RETURN]:                                              
                      ┌── credential_token: {                                
                      │       accountId: 'xDev';	                         
                      │       principleId: 'user:0000-0000-0000';                      
                      │       credentialTokenId: '1ae2f755xuw-q2-1px         
                      │       credentialTokenScope: 'session';		         
                      │       credentialTokenRevoked: false;                 
                      │       __issued: 1666291438;                          
                      │       __expires: 1766291438;
                      │   },                                                 
                      │   authorized_policies: [                             
                      │       `AWS-Auditor',                                 
                      │       'User'                                         
                      │   ]                                                  
                      │                                                      
                      └───────WEB────────┬────────┐                          
                       apps.xxx.io│  USER  │                          
                       ──────┬───────────┴────────┴───STORE-COOKIE┼          
                             │ CREDENTIAL:'1ae2f755xuw-q2-1px'  │            
                             │ ASSUMED-POLICY:AWS-Auditor       │            
                             ├────────────────────┬─────────────┘            
                             │AUTHENTICATED: TRUE │                          
                             └────────────────────┘
```

(4) The user makes a request (CEP\M)

```json
					 ┌──────────────┴────────────────────┴───────────────────┐
           │REQUEST:GET/compliance/evidence?type=aws HTTP/1.1      │
    (2)    │Authorization: "token 1ae2f755xuw-q2-1px/AWS-Auditor"  │
           └───────┬───────────────────────────────────────────────┘
                   │
              (SEND│REQUEST)
                   │
                   │
                   │
                   ▼

       GATEWAY / CENTRALIZED-ENFORCEMENT-MODEL (CEM)
      ┌────────────────────────────────────────────────────────┐             http://iam/resolve/1ae2f755xuw-q2-1px
      │                                                        ├──(1)─────►  => { user: '000-000-000', account: 'xDev'}
      │   (1) Validate AUTHORIZATION token credential          │
      │   (2) Fetch AUTHORIZATION token policy                 └───(2)─────► http://iam/000-000-000/assume/AWS-Auditor
      │                                                                      =>      authorizationPolicyNameId: `AWS-Auditor`,
      │                                                                          authorizationPolicyPrincipleRequirements: {
      │                                                                               ip_address: [10.00.01],
      │                                                                       },
      │                                                                          authorizationPolicyStatements: [
      │                                                                               "read":"query:*":[{"_tag":"aws"}],
      │                                                                               "read":"compliance:evidence":["*"],
      │                                                                               "read":"compliance:standard:*":[{"type":"aws"}],
      │                                                                               "read":"integration:instance:*":[{"id": ["aws_19300-22-876", "aws_19300-11-644"]}],
      │                                                                               "admin":"integration:sync:*":["*"]
      │                                                                               "admin":"question:*":["*"],
      │                                                                               "admin":"iam:token":["*"]
      │                                                                          ]
      │                                                                     }
      │   (3)   Inspect the REQUEST and GRANT/DENY
      │        (a) Is PrincipleRequirements GRANTED/DENIED
      │        (b) Is the requested resource attribution statement GRANTED/DENIED
      │            - relevant statement: "compliance:compliance/evidence/*":"compliance:evidence"
      │              - says that the attribute "compliance:evidence" is required.
      │              - the AWS-Auditor policy includes "read":"compliance:evidence":["*"], so GRANTED.
      │
     (4)   user: '000-000-000'
      │    account: 'xDev'
      │    filters: ["*"]
      └─   
                  │
                  │
                  │
                  │
                  ▼
     ┌──┬─────────────────────┬─┐
     │  │  FULLFIL REQUEST    │ │
     └──┴─────────────────────┴─┘
```

The following is part `(3)` of the previous block, expanded. *CEP determines if the policy grants access to the requested resource*

```jsx
GET https://xxxxx.io/compliance/evidence/aws_Xsfha-afg
	|
transalte (format "service":"path")
	|	
	= "compliance:compliance/evidence"	
	|
	▼
lookup (*best match* attribution statement)
	|
	= "compliance:compliance/evidence/*":"compliance:evidence"
	|
	▼
check (does the policy grant (a) statement's requirement resource; (b) the action)
	|
	= (policy has: "read":"compliance:evidence":[{"id":"aws_Xsfha-afg"}])
	= (requested-action: GET === "read")
	= (statement-required-resource: "compliance:evidence")
	|
	? GRANT or DENY
	|
	▼
grant ("read:compliance:evidence")
```

## (I) ACM: Resource Attributes And Discoverability Model (RAD\M)

RAD\M defines (a) the standard for service-by-service cataloging of public resources and endpoint→resource relationships; (b) the means to compile those catalogs and make them centrally discoverable.

A **resource** ****************represents some data type or action (or collection thereof), that is acted on by a service’s public API. 

- It’s a public-facing attribute (think, `s3_bucket`, `ecs_task`).
- It can be hierarchical, e.g.,  `LibraryItem`, `LibraryItem:Evidence`. (*note*) on the flip side, policies also use hierarchical statements e.g.,[ `read:LibraryItem:*` or `read:LibraryItem:Evidence:*` or `read:LibraryItem:Evidence:Note:*` ].

(a) The proposed standard is a configuration file at the root of every service with a public API; it contains two pieces of information: 

- *service resources***:** a ****listing of resources exposed by the service’s public API. *format*: `"service:resource"`
- *service statements*************************:************************ a path-by-path (or query-by-query / mutation-by-mutation) mapping of resources exposed by the service’s public API. *format*: `"service:path":"resource"`

```json
// compliance-service "service resources"
"compliance:controlsMapping",
"compliance:externalEvidence",
"compliance:framework",
"compliance:libraryItem",
"compliance:evidence",
"compliance:requirement",
"compliance:standard",

//compliance-service "service statements" (Public API)
"compliance:mutation/createControlMapping":"compliance:controlsMapping"
"compliance:mutation/uploadExternalEvidence":"compliance:externalEvidence"
"compliance:query/framework":"compliance:framework"
"compliance:query/noteEvidence":"compliance:evidence"
"compliance:query/userEvidenceWithUpload":"compliance:evidence"
"compliance:query/requirementNote":"compliance:requirement"
"compliance:query/requirementNoteUserEvidence":"compliance:requirement"
...
```

```json
// query-service "service resources"
"query:entity"
"query:relationship"
"query:vertex"
"query:edge"
"query:rawData"
"query:rawData:version"

// query-service "service-statements" (Public API)
"query:mutation/createRelationship":"query:relationship"
"query:mutation/updateRelationship":"query:relationship"
"query:query/relationship":"query:relationship"
"query:query/edge":"query:edge"
"query:query/entityRawData":"query:rawData"
"query:query/entityRawDataVersions":"query:rawData:version"
"query:mutation/upsertEntityRawData":"query:rawData"
"query:mutation/createEntity":"query:entity"
"query:mutation/updateEntity":"query:entity"
"query:mutation/deleteEntity":"query:entity"
"query:query/entityCount": "query:entity"
"query:query/typeCount":"query:entity"
"query:graph/vertexNeighbors":"query:vertex" //REST
...
```

(b) The ***************centralization*************** part of this model refers to the process in which a copy of each service’s catalog is persisted in a central location and used for discovery by several different processes e.g., enforcing authorization at the gateway; validating policies. [OCT.25] The mechanism for a “central broker” hasn’t been determined yet but I imagine it would look something like: 

- Each service uploads its configuration file to s3 in a pre-deployment hook.
- The services configuration files in s3 are either fetched and composed on each cache miss request by the centralization broker *or* they are stored compiled in S3 and polls for updates on some interval or trigger.
